var isFirefox=navigator.userAgent.indexOf("Firefox")!=-1?!0:!1,isIE=navigator.appName=="Microsoft Internet Explorer"?!0:!1,isChrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,isOpera=navigator.userAgent.toLowerCase().indexOf("opera")+1?1:0,ogMenu;isOpera&&(isIE=!1);var arStrHtml=[],arStrHead=[],arRHeadJs=[],arRBodyJs=[],arStrBody=[],arIsHtml=[],arHasGuides=[],linkExist=!1,arParams=[],arHistory=[],ptrCur=[],ptrIni=[],curTextRange,curNode,selNode,arFilPath=[],arFilExtn=[],viewMode=[],curRange=null,regTags=/([^<]*)(<head)([^<]+)(<\/head>)([^<]*)(<body)([^<]+)(<\/body>)([^<]*)/gi,regJs=/(<script)([^<]+)(<\/script>)/gi,blockChildElem=",BODY,ADDRESS,BLOCKQUOTE,DIV,FIELDSET,LEGEND,FORM,H1,H2,H3,H4,H5,H6,LI,P,TD,DD,DT,TH,",blockElem=",BODY,ADDRESS,BLOCKQUOTE,DIV,DL,FIELDSET,FORM,H1,H2,H3,H4,H5,H6,OL,UL,P,TABLE,",selEllist=",BODY,SPAN,DIV,DL,FIELDSET,FORM,H1,H2,H3,H4,H5,H6,OL,UL,P,TABLE,TR,TD,ADDRESS,BLOCKQUOTE,",$=function(n){return document.getElementById(n)},$$=function(n,t){return t.getElementsByTagName(n)},indtWidthForText="",indtWidthForHtml="",tempRange,isDocClicked=!1,curPos=0,screenId=-1,curScreenId=-1,execCmd=function(n,t,i){var r,u;switch(n){case"paste":pasteFromWebClipBoard(i);break;case"undo":viewMode[curScreenId]=="edit"&&execUndo();return;case"redo":viewMode[curScreenId]=="edit"&&execRedo();return;case"cut":cutSelected();break;default:if(r=getCurrentIframe(),viewMode[curScreenId]=="edit")u=getRange(),isIE?r.document.execCommand(n,!1,i):$("edit_iframe"+curScreenId.toString()).contentDocument.execCommand(n,!1,i);else return;r.window.focus()}isDocClicked=!0,updateHistry()},stripHtmlTags=function(n){var t=document.createElement("DIV");return t.innerHTML=n,t.textContent||t.innerText},wordcount=function(n){var t=trim(n).split(/\s/);return t.length},charCount=function(n){return n.length},charCountWithOutSpace=function(n){var t=n.replace(/[\s]+/g,"");return t.length},wordCharCount=function(){var i=$("edit_iframe"+curScreenId.toString()).contentWindow.document,n=stripHtmlTags(i.body.innerHTML);return'<fieldset class="ogEditor_dialgFieldset"><legend>Word/Character count</legend><label for="txtWord" class="label-txt">Word:</label><input value="'+wordcount(n)+'" class="ogEditorDialogTxtfield" name="txtWord" type="text" id="txtWord" /><br><label for="txtChar" class="label-txt">Character (with spaces):</label><input value="'+charCount(n)+'" class="ogEditorDialogTxtfield" name="txtChar" type="text" id="txtChar" /><br><label for="txtCharNoSpace" class="label-txt">Character (without spaces):</label><input value="'+charCountWithOutSpace(n)+'" class="ogEditorDialogTxtfield" name="txtCharNoSpace" type="text" id="txtCharNoSpace" /><br></fieldset>'},copyToWebClipBoard=function(){window.parent.OgEditor.copyToWebClipBoard()},paste=function(){window.parent.OgEditor.pasteFromWebClipBoard()},findNext=function(n,t,i){var u=!1,e=$("edit_iframe"+curScreenId.toString()),f,r;return window.find?u=e.contentWindow.find(n,t,i,!1,!1,!1,!1):document.selection&&document.selection.createRange&&(f=frames["edit_iframe"+curScreenId.toString()].window,f.focus(),curRange||(curRange=getRange()),curRange&&curRange.setEndPoint(i?"EndToStart":"StartToEnd",curRange),r=0,r=t?4:r,r=i?1:r,u=curRange.findText(n,i?-999999:999999,r),u&&curRange.select()),curRange=null,u},replaceWith=function(n,t,i){var e=$("edit_iframe"+curScreenId.toString()),u=getSelectedText(),f;return u&&(i?u===n:u.toLowerCase()===n.toLowerCase())?(isIE?(f=frames["edit_iframe"+curScreenId.toString()].window,f.focus(),curRange||(curRange=getRange()),curRange.pasteHTML(t)):e.contentWindow.document.execCommand("inserthtml",!1,t),curRange=null,!0):(curRange=null,!1)},replaceAll=function(n,t,i,r){for(var e,u,f;findNext(n,i,r);)curRange=getRange(),e=$("edit_iframe"+curScreenId.toString()),u=getSelectedText(),u&&(i?u===n:u.toLowerCase()===n.toLowerCase())&&(isIE?(f=frames["edit_iframe"+curScreenId.toString()].window,f.focus(),curRange.pasteHTML(t)):e.contentWindow.document.execCommand("inserthtml",!1,t));curRange=null},pasteFromWebClipBoard=function(n){var i=getRange(),t=$("edit_iframe"+curScreenId.toString());t.focus(),isIE?i.pasteHTML(n):t.contentWindow.document.execCommand("inserthtml",!1,n),isDocClicked=!0,updateHistry()},changeBGColor=function(n){var t=$("edit_iframe"+curScreenId.toString()).contentWindow.document;t.body.bgColor=n,isDocClicked=!0,updateHistry()},cutSelected=function(){var r=$("edit_iframe"+curScreenId.toString()),i,n,t;isIE?(i=frames["edit_iframe"+curScreenId.toString()].window,n=frames["edit_iframe"+curScreenId.toString()].document,n.selection.createRange&&(i.focus(),t=n.selection.createRange(),t.pasteHTML(""))):r.contentWindow.document.execCommand("inserthtml",!1,"")},getSelectedText=function(){curRange=getRange();var n;return n=isIE?curRange.text:curRange.toString()},getSelectedHtml=function(){var t,i,n;return curRange=getRange(),isIE?t=curRange.htmlText:(i=curRange.cloneContents(),n=document.createElement("div"),n.appendChild(i),t=trim(n.innerHTML)),t},doesLinkExist=function(){return linkExist},getExistingLinkAttr=function(){var t,n;if(linkExist=!1,curRange||(curRange=getRange()),t=[],n=getSelectedNode(),n.tagName.toUpperCase()!="A"&&(n=getElemWithTagName("A",n)),!n&&curNode&&curNode.tagName.toUpperCase()=="A"&&(n=curNode),n){linkExist=!0;for(var r=trim(getOuterHTML(n)),u=r.substring(0,r.indexOf(">")),f=/([^\s]+)([ \t]*=[ \t]*)(\'[^\']+\'|\"[^\"]+\"|[^\s]+)/g,i=0;match=f.exec(u);)t[i]=[],t[i].name=match[1].toLowerCase(),t[i].value=match[3].replace(/^[\'\"]|[\'\"]$/g,""),i++;curNode=n}return t},getElemsByClassName=function(n){var f=getCurrentIframe(),t;if(f){var r=f.document,i=r.all?r.all:r.getElementsByTagName("*"),u=[],e=new RegExp("\\b"+n+"\\b");for(t=0;t<i.length;t++)e.test(i[t].className)&&u.push(i[t]);return u}return null},setInit=function(){curRange=null,curTextRange=null,curNode=null,selNode=null,isDocClicked=!1},delSelBorder=function(){var t,n,i;if(viewMode[curScreenId]!=""&&viewMode[curScreenId]!="source"){if(t=getElemsByClassName("selElem"),t){for(n=0;n<t.length;n++)i=t[n].className.replace(/selElem/,""),i=trim(i),i==""?(t[n].removeAttribute("class"),t[n].removeAttribute("className")):t[n].className=i;return focusEditScreen(),!0}return!1}},moveCursor=function(n){var s,t,e,u,h,r,f,o;if(focusEditScreen(),s=getElemsByClassName("selElem"),s){for(t=s[0],e=t.childNodes,curPos>=e.length&&(curPos=0),u=0;u<e.length;u++)u==curPos&&(t=e[u]);if(isIE){var c=frames["edit_iframe"+curScreenId.toString()].document,l="marker_"+(""+Math.random()).slice(2),a='<span id="'+l+'">&nbsp;</span>',i=c.selection.createRange();t.nodeType==3&&(t=t.parentNode,curPos=0),i.moveToElementText(t),i.collapse(n),i.pasteHTML(a),o=c.getElementById(l),focusEditScreen(),i.moveToElementText(o),i.select(),o.parentNode.removeChild(o),curRange=i}else h=$("edit_iframe"+curScreenId.toString()),h.contentWindow.window.focus(),r=h.contentWindow.getSelection(),r.rangeCount&&(f=r.getRangeAt(0),f.selectNodeContents(t),f.collapse(n),r.removeAllRanges(),r.addRange(f));curPos++}},selectAllChildren=function(n){if(isIE){if(document.selection){var t=frames["edit_iframe"+curScreenId.toString()].document.selection.createRange();t.moveToElementText(n),t.select()}}else window.getSelection().selectAllChildren(n)},getExistingLinkInnerHtml=function(){curRange||(curRange=getRange());var n="";return curNode&&curNode.tagName.toUpperCase()=="A"&&(n=curNode.innerHTML),n},insertNewElement=function(n,t,i,r){var u,e,s,o,h,f;if(curRange||(curRange=getRange()),u="",n==""||!curNode||curNode.tagName.toLowerCase()!=n.toLowerCase())if(curNode&&curNode.tagName.toLowerCase()=="span")t=="style"&&(i=="font-family"?curNode.style.fontFamily=r:i=="font-size"&&(curNode.style.fontSize=r));else{if(e=isIE?curRange.text:curRange.toString(),e=="")return;isIE?(s=frames["edit_iframe"+curScreenId.toString()].window,s.focus(),o=curRange.htmlText,n!=""?(u="<"+n,t!=""&&(u+=t=="style"?i=="font-family"?' style="'+i+":'"+r+"';\"":' style="'+i+":"+r+';"':" "+t+'="'+r+'"'),u+=">",u+=o+"</"+n+">"):(u="<span",t!=""&&(u+=t=="style"?i=="font-family"?' style="'+i+":'"+r+"';\"":' style="'+i+":"+r+';"':" "+t+'="'+r+'"'),u+=">",u+=o+"</span>"),curRange.pasteHTML(u),curRange.select()):($("edit_iframe"+curScreenId.toString()).contentWindow.window.focus(),h=curRange.extractContents(),f=n!=""?document.createElement(n):document.createElement("span"),t!=""&&(t=="style"?i=="font-family"?f.setAttribute(t,i+":'"+r+"'"):f.setAttribute(t,i+":"+r):f.setAttribute(t,r)),f.appendChild(h),curRange.insertNode(f),curRange.selectNodeContents(f))}curRange=null,isDocClicked=!0,updateHistry()},getSelectedTextIE=function(){var n=getSelectedText()},findRange=function(){curRange=getRange()},clearRange=function(){curRange=null},focusDoc=function(){curRange&&isIE&&curRange.select()},getCurrentIframe=function(){return isIE?frames["edit_iframe"+curScreenId.toString()]:$("edit_iframe"+curScreenId.toString()).contentWindow},getRange=function(){var r,n,u,t,i;if(!$("edit_iframe"+curScreenId.toString()))return null;if(focusEditScreen(),isIE)u=frames["edit_iframe"+curScreenId.toString()].window,t=frames["edit_iframe"+curScreenId.toString()].document,u.focus(),r=t.selection.createRange(),curTextRange=t.body.createTextRange();else if(i=$("edit_iframe"+curScreenId.toString()),i.contentWindow.window.focus(),n=i.contentWindow.getSelection(),n&&n.rangeCount>0)r=n.getRangeAt(0);else return null;return r},execRedo=function(){var n=nextPtr(ptrCur[curScreenId]),t;n!=ptrIni[curScreenId]&&arHistory[curScreenId][n]!=""&&(t=arHistory[curScreenId][n],viewMode[curScreenId]=="source"?setSourceValue(unEscapeTags(t)):historyToEdit(unEscapeTags(t)),ptrCur[curScreenId]=n),getCurrentIframe().window.focus()},execUndo=function(){var n=prevPtr(ptrCur[curScreenId]),t;n!=ptrIni[curScreenId]&&arHistory[curScreenId][n]!=""&&(t=arHistory[curScreenId][n],viewMode[curScreenId]=="source"?setSourceValue(unEscapeTags(t)):historyToEdit(unEscapeTags(t)),ptrCur[curScreenId]=n),getCurrentIframe().window.focus()},historyToEdit=function(n){var i,t,r;initContents(n),i="",i=arHasGuides[curScreenId]=="yes"?retreiveContentsWithGuides("hasGuides"):retreiveContentsWithGuides(),t=getCurrentIframe().document,r=getCurrentIframe().window,removeDocEvents(!0),t.open(),isIE?t.write(setIEDocType(unEscapeTags(LFtoCRLF(i)))):t.write(unEscapeTags(LFtoCRLF(i))),t.close(),curNode=null,addDocEvents(),window.parent.OgEditor.clearAttriCssPane()},nextPtr=function(n){var i=parseInt(maxUndoRedo,10),t=n+1;return t==i&&(t=0),t},prevPtr=function(n){var i=parseInt(maxUndoRedo,10),t=n-1;return t<0&&(t=i-1),t},updateHistry=function(){var i,t;isDocClicked&&(i="",viewMode[curScreenId]!="source")&&(i=getContentsFromEditScreenForHistry(),ptrCur[curScreenId]=nextPtr(ptrCur[curScreenId]),ptrCur[curScreenId]==ptrIni[curScreenId]&&(ptrIni[curScreenId]=nextPtr(ptrIni[curScreenId])),arHistory[curScreenId][ptrCur[curScreenId]]=i,t=nextPtr(ptrCur[curScreenId]),t!=ptrIni[curScreenId]&&arHistory[curScreenId][t]!=""&&(arHistory[curScreenId][t]=""),isDocClicked=!1)},getSourceValue=function(){return CRLFtoLF($("source_area"+curScreenId.toString()).value)},setSourceValue=function(n){$("source_area"+curScreenId.toString()).value=LFtoCRLF(n)},insertCCtrl=function(n,t,i){var f="ogEditor_newControl_3fh8c76frtuf0s4",e,r,u;curRange||(curRange=getRange()),curRange?isIE?(e='<div id="'+f+'"></div>',curRange.pasteHTML(e),r=$("edit_iframe"+curScreenId.toString()).contentWindow.document.getElementById(f),r&&(r.innerHTML=n,r.removeAttribute("id"))):(u=document.createElement("div"),u.innerHTML=n,curRange.insertNode(u)):alert("please select range."),curRange=null,t&&t!=""&&addStyleForCCtrl(t,i),sourceToEdit(),window.parent.OgEditor.clearAttriCssPane(),window.parent.OgEditor.getInternalStyles(),isDocClicked=!0,updateHistry()},addStyleForCCtrl=function(n,t){var r="",e;if(n!=""){var l="",c=arStrHead[curScreenId],i=unEscapeTags(c);i=i.replace(/&/g,"&amp;"),i=i.replace(/</g,"&lt;"),i=i.replace(/>/g,"&gt;"),i=i.replace(/&lt;style/gi,"<style"),i=i.replace(/&lt;\/style&gt;/gi,"</style>");for(var s=0,h=/([^<]*)(<style)([^<]+)(<\/style>)/gi,f=!0;matchCss=h.exec(i);){f||(r+="\n&lt;/style&gt;");var o=matchCss[2]+matchCss[3].substring(0,matchCss[3].indexOf("&gt;")+4),u=matchCss[3].substring(matchCss[3].indexOf("&gt;")+4),a=matchCss[4];if(u.indexOf("ogEditor CControl: "+t)!=-1)return;r+=matchCss[1]+trim(o)+"\n"+trim(u),f=!1,s++}r+="\n\n"+n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"\n&lt;/style&gt;",e=/([^>]*)$/.exec(i),r+=e[0],r=trim(r)}r=r.replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&"),arStrHead[curScreenId]=escapeTags(trim(r))},insertElemt=function(n,t,i){if(isDocClicked=!0,updateHistry(),curRange||(curRange=getRange()),curRange){if(isIE?(frames["edit_iframe"+curScreenId.toString()].window.focus(),curRange.pasteHTML(t)):($("edit_iframe"+curScreenId.toString()).contentWindow.window.focus(),$("edit_iframe"+curScreenId.toString()).contentWindow.document.execCommand("inserthtml",!1,t)),i){var r=$("edit_iframe"+curScreenId.toString()).contentWindow.document.getElementById(i);r&&(selectNodeElem(r),r.removeAttribute("id"))}}else alert("please select range.");curRange=null},insertHyperLink=function(n,t){var u,i,f,r,e;if(curRange||(curRange=getRange()),isIE?frames["edit_iframe"+curScreenId.toString()].window.focus():$("edit_iframe"+curScreenId.toString()).contentWindow.window.focus(),curNode&&curNode.tagName.toUpperCase()=="A"){for(u=curNode,i=0;i<n.length;i++)if(n[i].name!="style")u.setAttribute(n[i].name,n[i].value);else for(f=n[i].value.split(";"),r=0;r<f.length;r++)f[r].indexOf(":")!=-1&&(e=f[r].split(":"),u.style[trim(e[0])]=trim(e[1]));u.innerHTML=t,selectNodeElem(u)}curRange=null,isDocClicked=!0,updateHistry()},selectNodeElem=function(n){var t;isIE?(t=frames["edit_iframe"+curScreenId.toString()].document.body.createTextRange(),t.moveToElementText(n),t.select()):$("edit_iframe"+curScreenId.toString()).contentWindow.window.getSelection().selectAllChildren(n)},htmlTextToNode=function(n){var t=document.createElement("div");return t.innerHTML=n,t.firstChild},insertNode=function(n,t){curRange||(curRange=getRange()),curRange?($("edit_iframe"+curScreenId.toString()).contentWindow.window.focus(),curRange.insertNode(t)):alert("please select range."),curRange=null},getSelectedNode=function(){var t,i,n,u,f,r;return isIE?(u=frames["edit_iframe"+curScreenId.toString()].window,f=frames["edit_iframe"+curScreenId.toString()].document,u.focus(),n=f.selection.createRange(),n.parentElement()):(r=$("edit_iframe"+curScreenId.toString()),r.contentWindow.window.focus(),i=r.contentWindow.getSelection(),n=i.getRangeAt?i.getRangeAt(0):i.createRange(),t=n.commonAncestorContainer?n.commonAncestorContainer:n.parentElement?n.parentElement():n.item(0),t)?t.nodeName=="#text"?t.parentNode:t:null},toc,ridex,cidex,numOfCell=0,numOfRow=0,tArray=[],getSelectedTable=function(){var n=getSelectedNode();n&&n.nodeName=="TD"&&(ridex=n.parentNode.rowIndex,cidex=n.cellIndex,toc=getElemWithTagName("TABLE",n))},tblInsertCell=function(n){isDocClicked=!0,updateHistry(),getSelectedTable(),addCell(n),focusEditScreen()},tblInsertRow=function(n){isDocClicked=!0,updateHistry(),getSelectedTable(),addRow(n),focusEditScreen()},tblMergeDown=function(){isDocClicked=!0,updateHistry(),getSelectedTable(),margeRow(),focusEditScreen()},tblMergeRight=function(){isDocClicked=!0,updateHistry(),getSelectedTable(),margeCell(),focusEditScreen()},tblDeleteRow=function(){isDocClicked=!0,updateHistry(),getSelectedTable(),removeRow(),focusEditScreen()},tblDeleteCell=function(){isDocClicked=!0,updateHistry(),getSelectedTable(),removeCell(),focusEditScreen()},addRow=function(n){var t,e,o,h,c,s,u;for(numOfCell=0,t=0;t<toc.tBodies[0].rows.length;t++)e=toc.tBodies[0].rows[t].cells.length,e>numOfCell&&(numOfCell=e);for(numOfRow=toc.tBodies[0].rows.length,makeMatrix(numOfCell,numOfRow),t=0;t<toc.tBodies[0].rows.length;t++)for(e=toc.tBodies[0].rows[t].cells.length,o=0;o<e;o++)h=toc.tBodies[0].rows[t].cells[o],h!=null&&subMatrixMethod(t,o,h);var r=ridex,f=0,i=0;if(n=="before"||n=="after"&&(r=ridex+1),toc.tBodies[0].insertRow(r),r==numOfRow)for(i=0;i<numOfCell;i++)u=document.createElement("TD"),u.innerHTML="&nbsp;",toc.tBodies[0].rows[r].appendChild(u);else for(i=0;i<numOfCell;i++)if(tArray[r][i]==-1){for(c=0,s=-3,f=r;f>-1;f--)tArray[f][i]!=-1&&s==-3&&(c=f,s=tArray[f][i]);u=document.createElement("TD"),toc.tBodies[0].rows[c].cells[s].rowSpan++}else u=document.createElement("TD"),u.innerHTML="&nbsp;",toc.tBodies[0].rows[r].appendChild(u);toc=null},removeRow=function(){var r,f,u,o,s,e,i;for(numOfCell=0,r=0;r<toc.tBodies[0].rows.length;r++)f=toc.tBodies[0].rows[r].cells.length,f>numOfCell&&(numOfCell=f);for(numOfRow=toc.tBodies[0].rows.length,makeMatrix(numOfCell,numOfRow),r=0;r<toc.tBodies[0].rows.length;r++)for(f=toc.tBodies[0].rows[r].cells.length,u=0;u<f;u++)o=toc.tBodies[0].rows[r].cells[u],o!=null&&subMatrixMethod(r,u,o);for(var h=0,n=0,t=0,n=0;n<numOfCell;n++)tArray[ridex][n]==cidex&&(h=n);for(n=0;n<numOfCell;n++)if(tArray[ridex][n]>-1){if(toc.tBodies[0].rows[ridex].cells[tArray[ridex][n]].rowSpan!=1){for(s=toc.tBodies[0].rows[ridex].cells[tArray[ridex][n]].rowSpan,s--,i=-3,t=n;t>-1;t--)tArray[ridex+1][t]>-1&&i==-3&&(i=tArray[ridex+1][t]);toc.tBodies[0].rows[ridex+1].insertCell(i+1),toc.tBodies[0].rows[ridex+1].cells[i+1].rowSpan=s}}else if(tArray[ridex][n]==-1){for(e=0,i=-3,t=ridex;t>-1;t--)tArray[t][n]!=-1&&i==-3&&(e=t,i=tArray[t][n]);toc.tBodies[0].rows[e].cells[i].rowSpan&&toc.tBodies[0].rows[e].cells[i].rowSpan--}toc.tBodies[0].deleteRow(ridex),toc=null},removeCell=function(){var t,u,f,o,e;for(numOfCell=0,t=0;t<toc.tBodies[0].rows.length;t++)u=toc.tBodies[0].rows[t].cells.length,u>numOfCell&&(numOfCell=u);for(numOfRow=toc.tBodies[0].rows.length,makeMatrix(numOfCell,numOfRow),t=0;t<toc.tBodies[0].rows.length;t++)for(u=toc.tBodies[0].rows[t].cells.length,f=0;f<u;f++)o=toc.tBodies[0].rows[t].cells[f],o!=null&&subMatrixMethod(t,f,o);for(var i=0,n=0,r=0,n=0;n<numOfCell;n++)tArray[ridex][n]==cidex&&(i=n);for(n=0;n<numOfRow;n++)if(tArray[n][i]>-1)toc.tBodies[0].rows[n].cells[tArray[n][i]].colSpan!=1?toc.tBodies[0].rows[n].cells[tArray[n][i]].colSpan--:toc.tBodies[0].rows[n].deleteCell(tArray[n][i]);else if(tArray[n][i]==-2){for(e=-3,r=i;r>-1;r--)tArray[n][r]!=-2&&e==-3&&(e=tArray[n][r]);toc.tBodies[0].rows[n].cells[e].colSpan&&toc.tBodies[0].rows[n].cells[e].colSpan--}toc=null},margeCell=function(){var t,f,e,s,o,i;for(numOfCell=0,t=0;t<toc.tBodies[0].rows.length;t++)f=toc.tBodies[0].rows[t].cells.length,f>numOfCell&&(numOfCell=f);for(numOfRow=toc.tBodies[0].rows.length,makeMatrix(numOfCell,numOfRow),t=0;t<toc.tBodies[0].rows.length;t++)for(f=toc.tBodies[0].rows[t].cells.length,e=0;e<f;e++)s=toc.tBodies[0].rows[t].cells[e],s!=null&&subMatrixMethod(t,e,s);for(var r=0,n=0,u=0,n=0;n<numOfCell;n++)tArray[ridex][n]==cidex&&(r=n);if(r!=numOfCell-1){if(o=-1,toc.tBodies[0].rows[ridex].cells.length==numOfCell)for(o=0,n=0;n<numOfRow;n++)ridex!=n&&toc.tBodies[0].rows[n].cells.length==numOfCell&&o++;if(o!=0&&toc.tBodies[0].rows[ridex].cells[tArray[ridex][r]].rowSpan==1){for(i=-3,u=r+1;u<numOfCell;u++)tArray[ridex][u]!=-2&&i==-3&&(i=tArray[ridex][u]);if(i!=-1){if(i!=-3){if(toc.tBodies[0].rows[ridex].cells[i].rowSpan!=1)return;toc.tBodies[0].rows[ridex].cells[i].colSpan!=1?toc.tBodies[0].rows[ridex].cells[i].colSpan--:toc.tBodies[0].rows[ridex].deleteCell(i)}else return;tArray[ridex][r]>-1&&toc.tBodies[0].rows[ridex].cells[tArray[ridex][r]]&&toc.tBodies[0].rows[ridex].cells[tArray[ridex][r]].colSpan++,toc=null}}}},margeRow=function(){var r,e,s,h,u,t,f;for(numOfCell=0,r=0;r<toc.tBodies[0].rows.length;r++)e=toc.tBodies[0].rows[r].cells.length,e>numOfCell&&(numOfCell=e);for(numOfRow=toc.tBodies[0].rows.length,makeMatrix(numOfCell,numOfRow),r=0;r<toc.tBodies[0].rows.length;r++)for(e=toc.tBodies[0].rows[r].cells.length,s=0;s<e;s++)h=toc.tBodies[0].rows[r].cells[s],h!=null&&subMatrixMethod(r,s,h);for(var o=0,n=0,i=0,n=0;n<numOfCell;n++)tArray[ridex][n]==cidex&&(o=n);if(ridex!=numOfRow-1&&toc.tBodies[0].rows[ridex].cells[tArray[ridex][o]].colSpan==1){for(u=-3,t=0,i=ridex+1;i<numOfRow;i++)tArray[i][o]!=-1&&u==-3&&(u=tArray[i][o],t=i);if(u!=-2){if(u!=-3){if(toc.tBodies[0].rows[t].cells[u].colSpan!=1)return;if(toc.tBodies[0].rows[t].cells[u].rowSpan!=1){if(f=-1,toc.tBodies[0].rows[t].cells.length==numOfCell)for(f=0,n=0;n<numOfRow;n++)t!=n&&toc.tBodies[0].rows[n].cells.length==numOfCell&&f++;if(f==0)return;toc.tBodies[0].rows[t].cells[u].rowSpan--}else{if(f=-1,toc.tBodies[0].rows[t].cells.length==numOfCell)for(f=0,n=0;n<numOfRow;n++)t!=n&&toc.tBodies[0].rows[n].cells.length==numOfCell&&f++;if(f==0)return;for(i=0;i<numOfCell;i++)if(tArray[t][i]>-1&&toc.tBodies[0].rows[t].cells[tArray[t][i]].rowSpan!=1)return;toc.tBodies[0].rows[t].deleteCell(u)}}else return;toc.tBodies[0].rows[ridex].cells[tArray[ridex][o]].rowSpan++,toc=null}}},addCell=function(n){var u,o,e,h,f,s;for(numOfCell=0,u=0;u<toc.tBodies[0].rows.length;u++)o=toc.tBodies[0].rows[u].cells.length,o>numOfCell&&(numOfCell=o);for(numOfRow=toc.tBodies[0].rows.length,makeMatrix(numOfCell,numOfRow),u=0;u<toc.tBodies[0].rows.length;u++)for(o=toc.tBodies[0].rows[u].cells.length,e=0;e<o;e++)h=toc.tBodies[0].rows[u].cells[e],h!=null&&subMatrixMethod(u,e,h);for(var i=0,r=0,t=0,r=0;r<numOfCell;r++)tArray[ridex][r]==cidex&&(i=r);if(n=="before"||n=="after"&&i++,i==-1)for(t=0;t<numOfRow;t++)toc.tBodies[0].rows[t].insertCell(0),toc.tBodies[0].rows[t].cells[tArray[t][0]].innerHTML="&nbsp;";else if(i==numOfCell)for(t=0;t<numOfRow;t++)f=toc.tBodies[0].rows[t].cells.length,toc.tBodies[0].rows[t].insertCell(f),toc.tBodies[0].rows[t].cells[f].innerHTML="&nbsp;";else for(t=0;t<numOfRow;t++)if(tArray[t][i]==-1)i==numOfCell-1?(f=toc.tBodies[0].rows[t].cells.length,toc.tBodies[0].rows[t].insertCell(f),toc.tBodies[0].rows[t].cells[f].innerHTML="&nbsp;"):i==0?(toc.tBodies[0].rows[t].insertCell(0),toc.tBodies[0].rows[t].cells[0].innerHTML="&nbsp;"):tArray[t][i+1]!=-1?(toc.tBodies[0].rows[t].insertCell(tArray[t][i+1]),toc.tBodies[0].rows[t].cells[tArray[t][i+1]].innerHTML="&nbsp;"):(f=toc.tBodies[0].rows[t].cells.length,toc.tBodies[0].rows[t].insertCell(f),toc.tBodies[0].rows[t].cells[f].innerHTML="&nbsp;");else if(tArray[t][i]==-2){for(s=-3,r=i;r>-1;r--)tArray[t][r]!=-2&&s==-3&&(s=tArray[t][r]);toc.tBodies[0].rows[t].cells[s].colSpan++}else toc.tBodies[0].rows[t].insertCell(tArray[t][i]),toc.tBodies[0].rows[t].cells[tArray[t][i]].innerHTML="&nbsp;";toc=null},makeMatrix=function(n,t){for(var r,i=0;i<t;i++)for(tArray[i]=new Array(n),r=0;r<n;r++)tArray[i][r]=0},makeMtxTable=function(n){var t,e,i,f,s,o,r;for(numOfCell=0,t=0;t<n.tBodies[0].rows.length;t++)e=n.tBodies[0].rows[t].cells.length,e>numOfCell&&(numOfCell=e);numOfRow=n.tBodies[0].rows.length,makeMatrix(numOfCell,numOfRow);var c=0,u=0,h=0;for(t=0;t<n.tBodies[0].rows.length;t++)for(e=n.tBodies[0].rows[t].cells.length,i=0;i<e;i++)if(f=n.tBodies[0].rows[t].cells[i],f!=null)if(f.rowSpan!="1")for(s=f.rowSpan,u=i,r=0;r<s;r++)u=r==0?assignVal(t,i,i):assignVal(t+r,u,-1);else if(f.colSpan!="1")for(o=f.colSpan,u=i,r=0;r<o;r++)r==0?u=assignVal(t,i,i):h=assignVal(t,u+r,-2);else h=assignVal(t,i,i)},assignVal=function(n,t,i){for(var r=t;tArray[n][r]!=0;)r++;return tArray[n][r]=i,r},subMatrixMethod=function(n,t,i){var s=0,u=0,o=0,e,f,r;if(i.rowSpan!="1")for(e=i.rowSpan,u=t,r=0;r<e;r++)u=r==0?assignVal(n,t,t):assignVal(n+r,u,-1);else if(i.colSpan!="1")for(f=i.colSpan,u=t,r=0;r<f;r++)r==0?u=assignVal(n,t,t):o=assignVal(n,u+r,-2);else o=assignVal(n,t,t)},init=function(){this.screenId=-1,this.curScreenId=-1,this.str="",$("editor").innerHTML="",RClickMenus.createOgMenus()},setActive=function(n){for(var t=screenId;t>=0;t--)n==t?$("editorPanel"+t.toString())&&($("editorPanel"+t.toString()).style.display="",curScreenId=t):$("editorPanel"+t.toString())&&($("editorPanel"+t.toString()).style.display="none")},addEvent=function(n,t,i){n.attachEvent?n.attachEvent("on"+t,i):n.addEventListener?n.addEventListener(t,i,!1):n["on"+t]=i},remEvent=function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent&&n.detachEvent("on"+t,i)},ptrLocalEvt=function(n,t,i){$("eventType").value=n,t&&($("eventCmd").value=t),i&&($("eventVal").value=i);var r=$("btnClickEventTriggered");r.click()},preview=function(){backUpContent();var n=unEscapeTags(retreiveContents());n=n.replace(/(<[\s]*\/[\s]*body[^>]*>)/i,"<br clear=both><form><hr><center><input type='submit' value='Close Window' onClick='window.close();return false; '></center></form>$1"),showPopup(n)},print=function(){backUpContent();var n=unEscapeTags(retreiveContents());n=arIsHtml[curScreenId]=="no"?"<html><head></head><body onload='print();'><pre>"+n+"</pre></body></html>":n.replace(/(<[\s]*body)/i,"<body onload='print();' $1"),showPopup(n)},showPopup=function(n){var t=window.open("","wPop","width=790,height=400,directories=no,menubar=yes,status=yes,toolbar=yes,resizable=yes,scrollbars=yes,screenY=0,top=0,screenX=0,left=0,modal=yes");t.document.writeln(n),t.document.close(),t.document.focus&&t.document.focus(!0)},getBodyContents=function(){var t=[],n=arStrBody[curScreenId].replace(/&lt;\/body&gt;/gi,"</body>"),i;return t[0]=n.substring(0,n.indexOf("&gt;")+4),i=n.substring(n.indexOf("&gt;")+4),t[1]=i.substring(0,i.indexOf("</body")),t[2]="&lt;/body&gt;",t},getHeadContents=function(){var t=[],n=arStrHead[curScreenId].replace(/&lt;\/head&gt;/gi,"</head>"),i;return t[0]=n.substring(0,n.indexOf("&gt;")+4),i=n.substring(n.indexOf("&gt;")+4),t[1]=i.substring(0,i.indexOf("</head")),t[2]="&lt;/head&gt;",t},isEditMode=function(){return viewMode[curScreenId]=="edit"},backUpContent=function(){var t,n;delSelBorder(),viewMode[curScreenId]=="source"?(n=getSourceValue(),initContents(n)):(t=$("edit_iframe"+curScreenId.toString()).contentWindow.document,n=arStrBody[curScreenId],n=n.substring(0,n.indexOf("&gt;")+4),arStrBody[curScreenId]=trim(n)+trim(escapeTags(CRLFtoLF(removeReadOnly(t.body))))+"\n&lt;/body&gt;")},formatHTMLwithColors=function(){var l,et,n,i,t,ft,o,r,g,h;if(arIsHtml[curScreenId]=="no"){alert("Tag Highlighter works with html file only.");return}var d="@@-- Js-Tag-Repl-Com --@@",w="@@-- Css-Tag-Repl-Com --@@",rt=$("edit_iframe"+curScreenId.toString()).contentWindow.document;backUpContent(),val="";for(var k=arStrHtml[curScreenId],b=arStrHead[curScreenId],ht=getBodyContents(),ot=unEscapeTags(k),nt=/(<[^<>]+>)([^<]*)/g,f="";match=nt.exec(ot);)o=match[2],match[1].indexOf("</")==-1?(l=makeStartTagWithColor(match[1]),l.indexOf("doctype")!=-1&&l.replace("doctype","DOCTYPE"),f+=l+o.replace("\n","<br>")):(r=match[1].replace("<","&lt;").replace(">","&gt;"),r=r.replace("&lt;/","&lt;/<span style='color: brown;'>").replace("&gt;","</span>&gt;"),f+=r+o.replace("\n","<br>"));k=f,et=indtWidthForHtml,n=unEscapeTags(b),n=n.replace(/([ \t]+)(<)/g,"$2"),n=n.replace(/&/g,"&amp;"),n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/&lt;script/gi,"<script"),n=n.replace(/&lt;\/script&gt;/gi,"<\/script>");for(var e=0,it=/(<script)([^<]+)(<\/script>)/gi,v=[];matchJs=it.exec(n);){i=matchJs[1]+matchJs[2].substring(0,matchJs[2].indexOf("&gt;")),i=makeStartTagWithColor(i);var t=matchJs[2].substring(matchJs[2].indexOf("&gt;")+4),ft=matchJs[3],ut="";if(t!=""){for(t=t.replace(/&lt;/gi,"<"),t=t.replace(/&gt;/gi,">"),t=t.replace(/&amp;/gi,"&"),t=ScriptFormatter.formatScriptCode(t,!0);/[\t]/.exec(t);)t=t.replace(/[\t]/,'<p style="margin:0 0 0 '+indentWidthForHtml+'px;display:inline-block;"><!----></p>');t=t.replace(/[\n]/g,"<br>"),t=t.replace(/<br>/gi,"</span><br><span style='color:green;'>"),v[e]=i+"<br><span style='color:green;'>"+trim(t)+"</span><br>&lt;/<span style='color: brown;'>script</span>&gt;<br>"}else v[e]=i+"&lt;/<span style='color: brown;'>script</span>&gt;<br>";e++}n=n.replace(/(<script)([^<]+)(<\/script>)/gi,d),n=n.replace(/&lt;style/gi,"<style"),n=n.replace(/&lt;\/style&gt;/gi,"</style>");for(var s=0,ct=/(<style)([^<]+)(<\/style>)/gi,y=[];matchCss=ct.exec(n);){if(i=matchCss[1]+matchCss[2].substring(0,matchCss[2].indexOf("&gt;")),i=makeStartTagWithColor(i),t=matchCss[2].substring(matchCss[2].indexOf("&gt;")+4),ft=matchCss[3],ut="",t!=""){for(t=t.replace(/&lt;/gi,"<"),t=t.replace(/&gt;/gi,">"),t=t.replace(/&amp;/gi,"&"),t=ScriptFormatter.formatScriptCode(t,!0);/[\t]/.exec(t);)t=t.replace(/[\t]/,'<p style="margin:0 0 0 '+indentWidthForHtml+'px;display:inline-block;"><!----></p>');t=t.replace(/[\n]/g,"<br>"),t=t.replace(/<br>/gi,"</span><br><span style='color:green;'>"),y[s]=i+"<br><span style='color:green;'>"+trim(t)+"</span><br>&lt;/<span style='color: brown;'>style</span>&gt;<br>"}else y[s]=i+"&lt;/<span style='color: brown;'>style</span>&gt;<br>";s++}for(n=n.replace(/(<style)([^<]+)(<\/style>)/gi,w),n=n.replace(/&lt;/gi,"<"),n=n.replace(/&gt;/gi,">"),n=n.replace(/&amp;/gi,"&"),f="";match=nt.exec(n);)o=match[2],match[1].indexOf("</")==-1?f+=makeStartTagWithColor(match[1])+o.replace("\n","<br>"):(r=match[1].replace("<","&lt;").replace(">","&gt;"),r=r.replace("&lt;/","&lt;/<span style='color: brown;'>").replace("&gt;","</span>&gt;"),f+=r+o.replace("\n","<br>"));for(n=f,e=0;n.indexOf(d)!=-1;)n=n.replace(d,v[e]),e++;for(s=0;n.indexOf(w)!=-1;)n=n.replace(w,y[s]),s++;b=n;var st=trim(unEscapeTags(ht[0])),tt=ScriptFormatter.colorTagStart("body",st),p=ScriptFormatter.textmakeIndentWithColor(val,rt.body,0);p=trim(p),g=tt+p+"<br>&lt;/<span style='color: brown;'>body</span>&gt;",val=trim(k)+"<br>"+trim(b)+"<br>"+trim(g)+"<br>&lt;/<span style='color: brown;'>html</span>&gt;",arIsHtml[curScreenId]!="no"&&toSource();for(var u=val,c=1,a="<table cellspacing='0' cellpadding='0' border='0' style='font-size:12px;'>";u.indexOf("<br>")!=-1;)h='<tr bgcolor="#ffffff">',c%2>0&&(h='<tr bgcolor="#f8f8f8">'),a+=h+'<td style="text-align:right;padding-right:5px;border-right:1px solid #aaa;color:#aaa;">'+c.toString()+'</td><td style="padding-left:5px;white-space: nowrap;">'+u.substring(0,u.indexOf("<br>"))+"</td></tr>",u=u.substring(u.indexOf("<br>")+4),c++;trim(u)!=""&&(h='<tr bgcolor="#ffffff">',c%2>0&&(h='<tr bgcolor="#f8f8f8">'),a+=h+'<td style="text-align:right;padding-right:5px;border-right:1px solid #aaa;color:#aaa;">'+c.toString()+'</td><td style="padding-left:5px;white-space: nowrap;">'+u+"</td></tr>"),a+="</table>",window.parent.OgEditor.showColoredHtmlDialg(a)},makeStartTagWithColor=function(n){var r="",i,t;return n=trim(n),n=n.substring(n.indexOf("<")+1),n=n.replace(">",""),i=n.split(/[ \t]/),t=i[0],r=ScriptFormatter.colorTagStart(t,n)},formatNonHTMLCode=function(){var t=getSourceValue(),n=ScriptFormatter.formatScriptCode(t,!1);window.parent.OgEditor.showFormatterDialg(n)},formatHTML=function(){var h="<!-- Js-Tag-Repl-Com -->",c="<!-- Css-Tag-Repl-Com -->",b=$("edit_iframe"+curScreenId.toString()).contentWindow.document,i,a;backUpContent(),val="";var w=arStrHtml[curScreenId],l=arStrHead[curScreenId],p=getBodyContents(),n=unEscapeTags(l);n=n.replace(/([ \t]+)(<)/g,"$2"),n=n.replace(/&/g,"&amp;"),n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/&lt;script/gi,"<script"),n=n.replace(/&lt;\/script&gt;/gi,"<\/script>");for(var r=0,y=/(<script)([^<]+)(<\/script>)/gi,o=[];matchJs=y.exec(n);){var e=matchJs[1]+matchJs[2].substring(0,matchJs[2].indexOf("&gt;")+4),t=matchJs[2].substring(matchJs[2].indexOf("&gt;")+4),k=matchJs[3],f="";t!=""?(t=t.replace(/&lt;/gi,"<"),t=t.replace(/&gt;/gi,">"),t=t.replace(/&amp;/gi,"&"),f=ScriptFormatter.formatScriptCode(t,!1),o[r]=e.replace("&gt;",">")+"\n"+f+"\n<\/script>"):o[r]=e.replace("&gt;",">")+"<\/script>",r++}for(n=n.replace(/(<script)([^<]+)(<\/script>)/gi,h),n=n.replace(/&lt;/gi,"<"),n=n.replace(/&gt;/gi,">"),n=n.replace(/&amp;/gi,"&"),r=0;n.indexOf(h)!=-1;)n=n.replace(h,o[r]),r++;n=n.replace(/&/g,"&amp;"),n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/&lt;style/gi,"<style"),n=n.replace(/&lt;\/style&gt;/gi,"</style>");for(var u=0,v=/(<style)([^<]+)(<\/style>)/gi,s=[];matchCss=v.exec(n);){var e=matchCss[1]+matchCss[2].substring(0,matchCss[2].indexOf("&gt;")+4),t=matchCss[2].substring(matchCss[2].indexOf("&gt;")+4),k=matchCss[3];f="",t!=""?(t=t.replace(/&lt;/gi,"<"),t=t.replace(/&gt;/gi,">"),t=t.replace(/&amp;/gi,"&"),f=ScriptFormatter.formatScriptCode(t,!1),s[u]=e.replace("&gt;",">")+"\n"+f+"\n</style>"):s[u]=e.replace("&gt;",">")+"</style>",u++}for(n=n.replace(/(<style)([^<]+)(<\/style>)/gi,c),n=n.replace(/&lt;/gi,"<"),n=n.replace(/&gt;/gi,">"),n=n.replace(/&amp;/gi,"&"),u=0;n.indexOf(c)!=-1;)n=n.replace(c,s[u]),u++;l=n,i=ScriptFormatter.textmakeIndent(val,b.body,0),i=i.replace(/^[\r\n|\n|\r]+/,""),i=i.replace(/[\r\n|\n|\r]+$/,""),/^[\r\n|\n|\r]+/.exec(i)&&alert("has return code"),a=escapeTags(trim(unEscapeTags(p[0]))+"\n"+i+"\n</body>"),val=trim(unEscapeTags(w))+"\n"+trim(l)+"\n"+trim(unEscapeTags(a))+"\n</html>",window.parent.OgEditor.showFormatterDialg(val)},getInternalStyles=function(){if(viewMode[curScreenId]!="edit")return null;var f="",u=arStrHead[curScreenId],n=unEscapeTags(u);n=n.replace(/&/g,"&amp;"),n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/&lt;style/gi,"<style"),n=n.replace(/&lt;\/style&gt;/gi,"</style>");for(var t=0,r=/(<style)([^<]+)(<\/style>)/gi,i=[];matchCss=r.exec(n);)i[t]=[],i[t].start=matchCss[1]+matchCss[2].substring(0,matchCss[2].indexOf("&gt;")+4),i[t].body=matchCss[2].substring(matchCss[2].indexOf("&gt;")+4),i[t].end=matchCss[3],t++;return i},updateInternalStyles=function(n){var i="",r,u,f;if(n){var h="",o=arStrHead[curScreenId],t=unEscapeTags(o);for(t=t.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/&lt;style/gi,"<style"),t=t.replace(/&lt;\/style&gt;/gi,"</style>"),r=0,u=/([^<]*)(<style)([^<]+)(<\/style>)/gi;matchCss=u.exec(t);){var s=matchCss[2]+matchCss[3].substring(0,matchCss[3].indexOf("&gt;")+4),e=n[r],c=matchCss[4];i+=matchCss[1]+trim(s)+"\n"+trim(e)+"\n&lt;/style&gt;",r++}f=/([^>]*)$/.exec(t),i+=f[0],i=trim(i)}i=i.replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&"),arStrHead[curScreenId]=escapeTags(trim(i)),sourceToEdit(),window.parent.OgEditor.getInternalStyles()},applyFormatterResult=function(n){arIsHtml[curScreenId]!="no"?(initContents(CRLFtoLF(n)),setSourceValue(unEscapeTags(retreiveContents())),viewMode[curScreenId]="source",$("source_div"+curScreenId.toString()).style.display="",$("edit_div"+curScreenId.toString()).style.display="none"):(initContents(CRLFtoLF(escapeTags(n))),setSourceValue(unEscapeTags(retreiveContents())))},getContentsForSave=function(){return(backUpContent(),arIsHtml[curScreenId]!="no")?LFtoCRLF(unEscapeTags(retreiveContents())):LFtoCRLF(retreiveContents())},toSource=function(){backUpContent(),setSourceValue(unEscapeTags(retreiveContents())),viewMode[curScreenId]="source",$("source_div"+curScreenId.toString()).style.display="",$("edit_div"+curScreenId.toString()).style.display="none"},sourceToEdit=function(){var t,n;backUpContent(),t="",t=arHasGuides[curScreenId]=="yes"?retreiveContentsWithGuides("hasGuides"):retreiveContentsWithGuides(),n=getCurrentIframe().document,removeDocEvents(!0),n.open(),isIE?n.write(setIEDocType(unEscapeTags(LFtoCRLF(t)))):n.write(unEscapeTags(LFtoCRLF(t))),n.close(),viewMode[curScreenId]="edit",$("source_div"+curScreenId.toString()).style.display="none",$("edit_div"+curScreenId.toString()).style.display="",addDocEvents(),window.parent.OgEditor.clearAttriCssPane(),curNode=null},trim=function(n){return n.toString().replace(/^\s+|\s+$/g,"")},insertEditorPane=function(){var u=document.createElement("div"),t,f,i,r,n,o,e;u.id="source_div"+curScreenId.toString(),u.className="source",u.style.width="100%",u.style.height="100%",u.style.border="0px",u.innerHTML='<textarea name="source_area" WRAP=off id="source_area'+curScreenId.toString()+'" style="width:100%; height:100%;resize: none;"></textarea>',t=document.createElement("div"),t.id="edit_div"+curScreenId.toString(),t.className="editDiv",t.style.width="100%",t.style.height="100%",t.style.border="0px",f=document.createElement("textarea"),f.id="edit_ta"+curScreenId.toString(),f.style.width="100%",f.style.height="100%",t.insertBefore(f,t.firstChild),i=document.createElement("div"),i.id="editorPanel"+curScreenId.toString(),i.insertBefore(u,i.firstChild),i.insertBefore(t,i.firstChild),i.style.width="100%",i.style.height="100%",i.style.border="0",isFirefox&&(i.style.overflow="auto"),$("editor").insertBefore(i,$("editor").firstChild),r=document.createElement("iframe"),r.id="edit_iframe"+curScreenId.toString(),r.className="editFrame",r.style.width="100%",r.style.height="100%",r.style.overflow="auto",r.frameBorder="0",f.style.display="none",t.insertBefore(r,t.firstChild),u.style.display="none",isIE?(n=frames["edit_iframe"+curScreenId.toString()].document,o=frames["edit_iframe"+curScreenId.toString()].window):(n=$("edit_iframe"+curScreenId.toString()).contentWindow.document,o=$("edit_iframe"+curScreenId.toString()).contentWindow.window),e="",e=arHasGuides[curScreenId]=="yes"?retreiveContentsWithGuides("hasGuides"):retreiveContentsWithGuides(),viewMode[curScreenId]="edit",isIE||(isOpera?n.designMode="on":(n.body.contentEditable=!0,n.designMode="on")),n.open(),isIE?n.write(setIEDocType(unEscapeTags(LFtoCRLF(e)))):n.write(unEscapeTags(LFtoCRLF(e))),n.close(),isIE&&(isOpera?n.designMode="on":(n.body.contentEditable=!0,n.designMode="on")),removeDocEvents(!0),addDocEvents(),window.parent.OgEditor.clearAttriCssPane()},setIEDocType=function(n){return n.replace(/<!DOCTYPE[ \t]+html[ \t]*?>/i,'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">')},addOnclickEventToChilds=function(){var i,t,n;if(viewMode[curScreenId]!="source")if(i=getCurrentIframe().document.body,i)for(t=i.childNodes,n=0;n<t.length;n++)t[n].nodeType==1&&(isIE?t[n].tagName.toUpperCase()=="INPUT"&&t[n].type=="text"||t[n].tagName.toUpperCase()=="TEXTAREA"?(remEvent(t[n],"dblclick",saveTempRange),remEvent(t[n],"focus",makeReadOnly),addEvent(t[n],"dblclick",saveTempRange),addEvent(t[n],"focus",makeReadOnly)):(remEvent(t[n],"click",getElemAttributes),addEvent(t[n],"click",getElemAttributes)):(remEvent(t[n],"click",getElemAttributes),addEvent(t[n],"click",getElemAttributes),(t[n].tagName.toUpperCase()=="INPUT"&&t[n].type=="text"||t[n].tagName.toUpperCase()=="TEXTAREA")&&(t[n].readOnly=!0)));else setTimeout(addOnclickEventToChilds,100)},removeOnclickEventFromChilds=function(){var i,t,n;if(viewMode[curScreenId]!="source"&&(i=getCurrentIframe().document.body,i))for(t=i.childNodes,n=0;n<t.length;n++)t[n].nodeType==1&&(isIE?t[n].tagName.toUpperCase()=="INPUT"&&t[n].type=="text"||t[n].tagName.toUpperCase()=="TEXTAREA"?(remEvent(t[n],"dblclick",saveTempRange),remEvent(t[n],"focus",makeReadOnly)):remEvent(t[n],"click",getElemAttributes):remEvent(t[n],"click",getElemAttributes))},addDocEvents=function(){var n=getCurrentIframe().document,t;window.File&&window.FileList&&window.FileReader&&(t=new XMLHttpRequest,t.upload&&(addEvent(n,"dragenter",cancelDefault),addEvent(n,"dragover",cancelDefault),addEvent(n,"dragleave",cancelDefault),addEvent(n,"drop",fileDripped))),addEvent(n,"contextmenu",showMenu),addEvent(n,"click",docClicked),addEvent(n,"mouseup",docMouseUp),addEvent(n,"keyup",updateHistry),addOnclickEventToChilds()},removeDocEvents=function(n){var t=getCurrentIframe().document,i;window.File&&window.FileList&&window.FileReader&&(i=new XMLHttpRequest,i.upload&&(remEvent(t,"dragenter",cancelDefault),remEvent(t,"dragover",cancelDefault),remEvent(t,"dragleave",cancelDefault),remEvent(t,"drop",fileDripped))),remEvent(t,"contextmenu",showMenu),remEvent(t,"click",docClicked),remEvent(t,"mouseup",docMouseUp),remEvent(t,"keyup",updateHistry),removeOnclickEventFromChilds(),n&&setInit()},saveTempRange=function(){tempRange=getRange()},makeReadOnly=function(n){var i,t;n=window.event||n,i=n.target!=null?n.target:n.srcElement,(i.tagName.toUpperCase()=="INPUT"&&i.type=="text"||i.tagName.toUpperCase()=="TEXTAREA")&&(t=frames["edit_iframe"+curScreenId.toString()].document.body.createTextRange(),t.moveToElementText(frames["edit_iframe"+curScreenId.toString()].document.body),t.startContainer=frames["edit_iframe"+curScreenId.toString()].document.body,t.startOffset=0,t.endContainer=frames["edit_iframe"+curScreenId.toString()].document.body,t.endOffset=0,t.collapse(!0),t.select(),setTimeout(function(){tempRange&&(tempRange.select(),getElemAttributes(n,i))},30)),n.preventDefault&&n.preventDefault(),n.returnValue=!1},removeReadOnly=function(n){var r=document.createElement("div"),i,t;if(n&&n.innerHTML)for(r.innerHTML=n.innerHTML,i=r.childNodes,t=0;t<i.length;t++)i[t].nodeType==1&&(i[t].tagName.toUpperCase()=="INPUT"&&i[t].type=="text"||i[t].tagName.toUpperCase()=="TEXTAREA")&&i[t].removeAttribute("readOnly");return r.innerHTML},fileDripped=function(n){var r,t,i;for(cancelDefault(n),r=n.target.files||n.dataTransfer.files,t=0;i=r[t];t++)processFile(i)},processFile=function(n){var r=new FileReader,i,t;r.onload=function(t){$("newFileContents").value=escapeTags(t.target.result),window.parent.OgEditor.newFile("/"+n.name,"default",$("newFileContents").value)},n.type.indexOf("text")>=0&&(i=DefaultEncoding,t="readAsText",r[t](n,i))},docClicked=function(){RClickMenus.hideMenus(),isDocClicked=!0,isIE&&window.parent.OgEditor.hideOgNavMenus()},getElemAttributes=function(n,t){selNode=getElemNode(n,t),passElemAttributes(selNode),setElemNodePath()},getElemNode=function(n,t){var i;return t?i=t:(n=n?n:event?event:null,n&&(i=n.target?n.target:n.srcElement)),i},passElemAttributes=function(n){var u,t,e;if(viewMode[curScreenId]!="source"){var r=n,l=[],i="",c="";if(r.tagName){if(r.tagName.toUpperCase()!="BODY"&&(u=trim(getOuterHTML(r)),u&&u!=""&&u.indexOf(">")!=-1)){i="<legend>Attributes</legend>",i+='<input class="ogEditorDialogButton" id="btnAddElemAtts" type="button" value="Add attribute" style="font-size:8px;margin:0 5px 10px 0;" onclick="OgEditor.openDialog(\'dialgNewAttribute\',null,\'Add attribute\',null);"/><br>',i+='<div id="divAttri">';for(var f="",h=u.substring(0,u.indexOf(">")),s=/([^\s]+)([ \t]*=[ \t]*)(\'[^\']+\'|\"[^\"]+\"|[^\s]+)/g,o=0;match=s.exec(h);)t=match[3].replace(/^[\'\"]|[\'\"]$/g,""),match[1].toLowerCase()!="readonly"&&t!=""&&(match[1].toLowerCase()=="style"?f+='<label class="attribute">'+match[1]+'</label><textarea id="cssEditorDialogStyle" class="cssEditorDialogStyle" name="'+match[1]+'" cols="34" rows="20">'+match[3].replace(/^[\'\"]|[\'\"]$/g,"")+"</textarea><br>":(t=t==""?"true":t,match[1].toLowerCase()=="class"&&t.indexOf("selElem")!=-1?(t=t.replace("selElem",""),t&&trim(t)!=""&&(i+='<label class="attribute">'+match[1]+'</label><input class="cssEditorDialogAttributes" name="'+match[1]+'" value="'+t+'" type="text" /><br>')):i+='<label class="attribute">'+match[1]+'</label><input class="cssEditorDialogAttributes" name="'+match[1]+'" value="'+t+'" type="text" /><br>'),o++);i+="</div>",f==""&&(f+='<label class="attribute">style</label><textarea id="cssEditorDialogStyle" class="cssEditorDialogStyle" name="style" cols="34" rows="15"></textarea><br>'),i=i+f}selEllist.indexOf(","+r.tagName.toUpperCase()+",")!=-1&&(e=getSelectedText(),e==""&&(delSelBorder(),r.className.indexOf("selElem")==-1&&(r.className=r.className==""?"selElem":r.className+" selElem"))),curPos=0,curNode=r}window.parent.OgEditor.setElemAttributes(i)}},setElemNodePath=function(){var n=selNode,t=[],i=0;do t.unshift(n.nodeName.toLowerCase()),i++;while(n.nodeName.toLowerCase()!="html"&&(n=n.parentNode));nodePath=t.join("="),window.parent.OgEditor.setElemNodePath(nodePath)},visitNode=function(n){var i,t,r;if(selNode){for(i=selNode,t=0;t!=n&&t<n;)i=i.parentNode,t++;r=i,passElemAttributes(r)}},updateElemAttributes=function(n,t){var i,u,r,f;if(viewMode[curScreenId]!="source"){if(curNode){for(i=0;i<n.length;i++)curNode.removeAttribute(n[i].name);for(curNode.style&&curNode.removeAttribute("style"),i=0;i<n.length;i++)curNode.setAttribute(n[i].name,n[i].value);if(t!="")for(u=t.split(";"),r=0;r<u.length;r++)u[r].indexOf(":")!=-1&&(f=u[r].split(":"),curNode.style[trim(f[0])]=trim(f[1]))}alert("Attributes and styles are successfully updated.")}},docMouseUp=function(){window.parent.OgEditor.ogDDListItemClicked()},focusEditScreen=function(){arIsHtml[curScreenId]!="no"&&$("edit_iframe"+curScreenId.toString())&&(isIE?frames["edit_iframe"+curScreenId.toString()].window.focus():$("edit_iframe"+curScreenId.toString()).contentWindow.window.focus())},showMenu=function(n){var r=getSelectedNode(),t=getElemWithTagName("TABLE",r),i="general";t&&(i=t.tagName),RClickMenus.showMenu(n,i)},insertScriptPane=function(){var t=document.createElement("div"),n,i;t.id="source_div"+curScreenId.toString(),t.className="source",t.style.width="100%",t.style.height="100%",t.style.border="0px",t.innerHTML='<textarea name="source_area" WRAP=off id="source_area'+curScreenId.toString()+'" style="width:100%; height:100%;resize: none;"></textarea>',n=document.createElement("div"),n.id="editorPanel"+curScreenId.toString(),n.insertBefore(t,n.firstChild),n.style.width="100%",n.style.height="100%",n.style.border="0px",$("editor").insertBefore(n,$("editor").firstChild),i=arStrBody[curScreenId],viewMode[curScreenId]="source",$("source_area"+curScreenId.toString()).value=LFtoCRLF(i)},addHtmlEditor=function(){insertEditorPane(),setActive(curScreenId)},addScriptEditor=function(){insertScriptPane(),setActive(curScreenId)},closeFile=function(n){for(var t=-1,r,i=0;i<arFilPath.length;i++)arFilPath[i]==n&&(t=i);t>-1&&(arFilPath[t]="",arStrHtml[t]="",arStrHead[t]="",arRHeadJs[t]="",arRBodyJs[t]="",arStrBody[t]="",r=$("editorPanel"+t.toString()),$("editor").removeChild(r),viewMode[t]="")},makeRelativePath=function(n,t){var i="",r;if(t.indexOf(n)==0)i=t.replace(n,"");else{for(r=/(\/)/g;match=r.exec(n);)i+="../";i+=t.replace(/^\//,"")}return i.replace(/^\//,"")},CRLFtoLF=function(n){var t=n.replace(/(\r\n)/g,"\n");return t=t.replace(/(\r)/g,"\n")},LFtoCRLF=function(n){return n.replace(/(\n)/g,"\r\n")},LFtoCR=function(n){return n.replace(/(\n)/g,"\r")},openFile=function(n,t){var i,u,r,s,f,o,e;for(curNode=null,u=0;u<arFilPath.length;u++)if(arFilPath[u]==t){setActive(u),n&&n!=""&&(arIsHtml[curScreenId]=="no"?(initContents(CRLFtoLF(n)),i=arStrBody[curScreenId],$("source_area"+curScreenId.toString()).value=LFtoCRLF(i)):(initContents(CRLFtoLF(n)),i="",i=arHasGuides[curScreenId]=="yes"?retreiveContentsWithGuides("hasGuides"):retreiveContentsWithGuides(),r=getCurrentIframe().document,r.open(),isIE?r.write(setIEDocType(unEscapeTags(LFtoCRLF(i)))):r.write(unEscapeTags(LFtoCRLF(i))),r.close(),$("source_div"+curScreenId.toString()).style.display="none",$("edit_div"+curScreenId.toString()).style.display="",removeDocEvents(!0),addDocEvents()));return}i=CRLFtoLF(n),screenId++,s=parseInt(maxUndoRedo,10),arHistory[screenId]=new Array(s),ptrCur[screenId]=0,ptrIni[screenId]=0,initializeHistory(screenId),arFilPath[screenId]=t,f=getFileExtension(t),arFilExtn[screenId]=f,curScreenId=screenId,htmlExt.indexOf(","+f+",")<0?(arIsHtml[curScreenId]="no",initContents(i),$("eventType").value="addScriptEditor"):(arIsHtml[curScreenId]="yes",o=convertToHTML(i),initContents(o),$("eventType").value="addHtmlEditor"),arHasGuides[curScreenId]="yes",window.parent.OgEditor.updateGuideBtn(arHasGuides[curScreenId]),e=$("btnClickEventTriggered"),e.click()},initializeHistory=function(n){for(var t=0;t<arHistory[n].length;t++)arHistory[n][t]="";ptrCur[n]=0,ptrIni[n]=0},showOrHideGuides=function(n){if(viewMode[curScreenId]=="source"){alert("Please switch into Edit mode first!");return}arHasGuides[curScreenId]=="yes"?(n==""||n=="false")&&(arHasGuides[curScreenId]="no"):(n==""||n=="true")&&(arHasGuides[curScreenId]="yes"),sourceToEdit(),window.parent.OgEditor.updateGuideBtn(arHasGuides[curScreenId])},isGuideVisible=function(){return arHasGuides[curScreenId]=="yes"},convertToHTML=function(n){var t=n,a=/(<\?xml.*?\?>[\s]*)?(<!DOCTYPE.*?>[\s]*)?(<html.*?>[\s]*)(<head.*?>)/i,e,u,r,i,f,c,l,s,o,h;return e=u=r=i=f=l="",e=/^[\s]*<\?xml.*?\?>[\s]*/i.exec(t)?/^<\?xml.*?\?>[\s]*/i.exec(t):"",u=/<!DOCTYPE.*?>[\s]*/i.exec(t)?/<!DOCTYPE.*?>[\s]*/i.exec(t):"",r=/<html.*?>[\s]*/i.exec(t)?/<html.*?>[\s]*/i.exec(t):"",i=/<head.*?>/i.exec(t)?/<head.*?>/i.exec(t):"",s=e+u+r+i,o="",i==""?i="<head></head>":(i=t.substring(t.toLowerCase().indexOf("<head"),t.toLowerCase().indexOf("</head>")+7),o=t.substring(t.toLowerCase().indexOf("</head>")+7)),s!=""&&(t=t.substring(s.length)),u=emptyToVal(u,'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">\n'),r=emptyToVal(r,"<html>\n"),h=/^([\s]*<body.*?>)/i,match=h.exec(o),match&&match[1]!=undefined?(f="\n"+t.substring(t.toLowerCase().indexOf("<body"),t.toLowerCase().indexOf("</body>")+7),t=t.substring(t.toLowerCase().indexOf("</body>")+7)):f="\n<body>"+t+"</body>",c="\n</html>",e+u+r+i+f+c},emptyToVal=function(n,t){return n==""?t:n},getFileExtension=function(n){return/[\.]/.exec(n)?/[^\.]+$/.exec(n):undefined},clickEventTriggered=function(){var i=$("eventType").value,t=$("eventCmd").value,n=$("eventVal").value;switch(i){case"formatHTML":formatHTML();break;case"formatNonHTMLCode":formatNonHTMLCode();break;case"addHtmlEditor":addHtmlEditor();break;case"addScriptEditor":addScriptEditor();break;case"toSource":viewMode[curScreenId]=="edit"&&toSource();break;case"sourceToEdit":viewMode[curScreenId]=="source"&&sourceToEdit();break;case"preview":preview();break;case"print":print();break;case"findRange":findRange();break;case"execCmd":execCmd(t,null,n);break;case"getSelectedTextIE":getSelectedTextIE()}$("eventType").value="",$("eventCmd").value="",$("eventVal").value=""},escapeOpenAndEndTagForHeadBody=function(n){return n.replace(/<head/i,"&lt;head").replace(/<\/head>/i,"&lt;/head&gt;").replace(/<body/i,"&lt;body").replace(/<\/body>/i,"&lt;/body&gt;")},unEscapeOpenAndEndTagForHeadBody=function(n){return n.replace(/(&lt;head)([ &])/i,"<head$2").replace(/&lt;\/head&gt;/i,"</head>").replace(/(&lt;body)([ &])/i,"<body$2").replace(/&lt;\/body&gt;/i,"</body>")},initContents=function(n){var t,f,u,e,r,i;if(arIsHtml[curScreenId]=="no"){arStrBody[curScreenId]=n;return}for(t=escapeTags(n),t=unEscapeOpenAndEndTagForHeadBody(t),e=[],i=0;match=regTags.exec(t);)f=match[1],u=match[2]+match[3]+match[4],r=match[6]+match[7]+match[8],i++;i>1,arStrHtml[curScreenId]=f,arStrHead[curScreenId]=escapeOpenAndEndTagForHeadBody(u),arStrBody[curScreenId]=escapeOpenAndEndTagForHeadBody(r)},retreiveContentsWithGuides=function(n){var t=pathToOgEditor,u;if(t=t=="/"?"":t.replace(/\/$/,""),u=t+"/script/dragEvent.htc",arIsHtml[curScreenId]=="no")return arStrBody[curScreenId];var f=arStrHtml[curScreenId],r=getHeadContents(),e=arStrBody[curScreenId],i=trim(r[0])+"\n"+trim(r[1])+'\n&lt;style type="text/css"&gt;&lt;!--';return isIE&&(i+="body{behavior:url("+u+");}"),n&&n=="hasGuides"&&(i+="table {border:1px dotted gray;width:200px;}.pagebreak{height: 10px;background: url("+t+"/img/pagebreak.gif) no-repeat center center;width:100%;}td{border:1px dotted gray;empty-cells: show;}.selElem{border:1px solid #aaa;background-color:#eee;}"),i+="--&gt;&lt;/style&gt;\n"+trim(r[2]),trim(f)+"\n"+i+"\n"+trim(e)+"\n&lt;/html&gt;"},retreiveContents=function(){if(arIsHtml[curScreenId]=="no")return arStrBody[curScreenId];var i=arStrHtml[curScreenId],t=arStrHead[curScreenId],n=arStrBody[curScreenId];return trim(i)+"\n"+trim(t)+"\n"+trim(n)+"\n&lt;/html&gt;"},getContentsFromSourceScreen=function(){return escapeTags(getSourceValue())},retreiveContentsFromEditScreen=function(){var t;delSelBorder();var i=arStrHtml[curScreenId],r=arStrHead[curScreenId],u=$("edit_iframe"+curScreenId.toString()).contentWindow.document,n=arStrBody[curScreenId];return n=n.substring(0,n.indexOf("&gt;")+4),t=trim(n)+"\n"+trim(escapeTags(CRLFtoLF(removeReadOnly(u.body))))+"\n&lt;/body&gt;",trim(i)+"\n"+trim(r)+"\n"+t+"\n&lt;/html&gt;"},getContentsFromEditScreenForHistry=function(){var i=arStrHtml[curScreenId],r=arStrHead[curScreenId],u=$("edit_iframe"+curScreenId.toString()).contentWindow.document,n=arStrBody[curScreenId],t;return n=n.substring(0,n.indexOf("&gt;")+4),t=trim(n)+"\n"+trim(escapeTags(CRLFtoLF(removeReadOnly(u.body))))+"\n&lt;/body&gt;",trim(i)+"\n"+trim(r)+"\n"+t+"\n&lt;/html&gt;"},unEscapeTags=function(n){return n.replace(/&#39;/g,"'").replace(/&quot;/gi,'"').replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&")},escapeTags=function(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;").replace(/\u00a9/g,"&copy;").replace(/\u00ae/g,"&reg;").replace(/\u2122/g,"&trade;").replace(/\u00a2/g,"&cent;").replace(/\u00a3/g,"&pound;").replace(/\u00a4/g,"&curren;").replace(/\u00a5/g,"&yen;").replace(/\u20ac/g,"&euro;")},cancelDefault=function(n){var n=window.event||n;n.preventDefault&&n.preventDefault(),n.returnValue=!1},writeBody=function(){var n=document.createElement("form"),t,o,e,f,s,r,u,i;n.name="edform",n.id="edform",document.body.appendChild(n),t=document.createElement("div"),t.id="editor",t.style.position="absolute",t.style.top="0px",t.style.left="0px",n.appendChild(t),o=document.createElement("textarea"),o.id="newFileContents",o.style.display="none",n.insertBefore(o,n.firstChild),e=document.createElement("input"),e.type="hidden",e.id="eventType",f=document.createElement("input"),f.type="hidden",f.id="eventCmd",s=document.createElement("input"),s.type="hidden",s.id="eventVal",r=document.createElement("input"),r.type="hidden",r.id="hidePathToOgEditor",u=document.createElement("input"),u.type="hidden",u.id="webClipboard",i=document.createElement("input"),i.type="button",i.id="btnClickEventTriggered",addEvent(i,"click",clickEventTriggered,!1),n.insertBefore(i,n.firstChild),n.insertBefore(e,n.firstChild),n.insertBefore(f,n.firstChild),n.insertBefore(s,n.firstChild),n.insertBefore(r,n.firstChild),n.insertBefore(u,n.firstChild)},load=function(){var t,i,n;for(writeBody(),window.File&&window.FileList&&window.FileReader?(t=new XMLHttpRequest,t.upload&&(remEvent(document.body,"dragenter",cancelDefault),remEvent(document.body,"dragover",cancelDefault),remEvent(document.body,"dragleave",cancelDefault),remEvent(document.body,"drop",fileDripped),addEvent(document.body,"dragenter",cancelDefault),addEvent(document.body,"dragover",cancelDefault),addEvent(document.body,"dragleave",cancelDefault),addEvent(document.body,"drop",fileDripped))):(remEvent(document.body,"dragenter",cancelDefault),remEvent(document.body,"dragover",cancelDefault),remEvent(document.body,"drop",cancelDefault),addEvent(document.body,"dragenter",cancelDefault),addEvent(document.body,"dragover",cancelDefault),addEvent(document.body,"drop",cancelDefault)),i=indentWidthForText,n=0;n<i;n++)indtWidthForText+=" ";indtWidthForHtml='<p style="margin:0 0 0 '+indentWidthForHtml+'px;display:inline-block;"><!----></p>',init()},getParameters=function(){for(var f=window.location.search.substring(1),i=f.split("&"),t,r,u,n=0;n<i.length;n++)t=i[n].indexOf("="),t>0&&(r=i[n].substring(0,t),u=i[n].substring(t+1),arParams[r]=u)},getElemWithTagName=function(n,t){while(t!=null&&t.tagName!=n)t=t.parentNode;return t},getOuterHTML=function(n){return n.outerHTML?n.outerHTML:(new XMLSerializer).serializeToString(n)};(function(){var rt="<COMM5>",b=/(\/)(.+)([^\\])(\/)/g,e=[],ut=/(.*?)(<COMM5>)/g,ft="<COMM1>",d=/(\/\/)(.*?)(\n)/g,t=[],it=/(.*?)(<COMM1>)/g,tt="<COMM2>",g=/(\/\*\/?)(.*?)(\*\/)/g,i=[],lt=/(.*?)(<COMM2>)/g,st="<COMM4>",k=/([^\/\n]*?)([^\\])(\')(.*?)([^\\])(\')/g,r=[],ht=/(.*?)(<COMM4>)/g,at="<COMM7>",nt=/([^\/\n]*?)([^\\])(\'\')/g,u=[],ct=/(.*?)(<COMM7>)/g,ot="<COMM3>",s=/([^\/\n]*?)([^\\])(\")(.*?)([^\\])(\")/g,n=[],vt=/(.*?)(<COMM3>)/g,yt="<COMM6>",h=/([^\/\n]*?)([^\\])(\"\")/g,f=[],et=/(.*?)(<COMM6>)/g,y=function(n,t,i){var h=indtWidthForText,l=!0,u,r,c,e,o,f,s;for(i=i+1,u=t.childNodes,r=0;r<u.length;r++)if(u[r].nodeName=="#text"){if(u[r].nodeValue!="undefined"&&trim(u[r].nodeValue)!=""){for(c=trim(u[r].nodeValue),/[\r\n|\n|\r]+$/.exec(n)||(n+="\n"),e=0;e<i;e++)n+=h;n+=c}}else if(u[r].nodeName=="#comment"){for(/[\r\n|\n|\r]+$/.exec(n)||(n+="\n"),e=1,e=0;e<i;e++)n+=h;n+=l?"<!--"+trim(u[r].nodeValue)+"-->":"<!--"+u[r].nodeValue+"-->"}else if(u[r].nodeName=="#cdata-section")alert("cd data");else if(u[r].nodeName!="#document-fragment"&&u[r].nodeName!="#document"&&u[r].tagName!="undefined"&&trim(u[r].tagName)!=""){for((u[r].tagName.toUpperCase()=="INPUT"&&u[r].type=="text"||u[r].tagName.toUpperCase()=="TEXTAREA")&&u[r].removeAttribute("readOnly"),/[\r\n|\n|\r]+$/.exec(n)||(n+="\n"),e=1,e=0;e<i;e++)n+=h;if(u[r].tagName=="IMG"||u[r].tagName=="INPUT"||u[r].tagName=="BR"||u[r].tagName=="A")f=trim(getOuterHTML(u[r])),n+=f;else if(u[r].tagName=="SCRIPT")f=trim(getOuterHTML(u[r])),f&&f!=""&&f.indexOf(">")!=-1&&(s=f.substring(0,f.indexOf(">")+1),n+=trim(s)+"\n",n=n.replace(/([ \t]+)(<SCRIPT)/gi,"$2"),o=f.substring(f.indexOf(">")+1),o=o.replace(/<\/SCRIPT>/i,""),o=ScriptFormatter.formatScriptCode(o,!1),n+=trim(o),/[\r\n|\n|\r]+$/.exec(n)||(n+="\n"),n+="</"+trim(u[r].tagName.toLowerCase())+">");else if(f=trim(getOuterHTML(u[r])),f&&f!=""&&f.indexOf(">")!=-1){for(s=f.substring(0,f.indexOf(">")+1),n+=s,n=ScriptFormatter.textmakeIndent(n,u[r],i),/[\r\n|\n|\r]+$/.exec(n)||(n+="\n"),e=0;e<i;e++)n+=h;n+="</"+trim(u[r].tagName.toLowerCase())+">"}}return n},p=function(n,t,i){var h=indentWidthForHtml,v=!0,u,r,l,o,e,a,f,s,c;for(i=i+1,u=t.childNodes,r=0;r<u.length;r++)if(u[r].nodeName=="#text")u[r].nodeValue!="undefined"&&trim(u[r].nodeValue)!=""&&(l=trim(u[r].nodeValue),/[\r\n|\n|\r]+$/.exec(n)||(n+="<br>"),o='<p style="margin:0 0 0 '+(h*i).toString()+'px;display:inline-block;"><!----></p>',n+=o,n+=l);else if(u[r].nodeName=="#comment")/[\r\n|\n|\r]+$/.exec(n)||(n+="<br>"),o='<p style="margin:0 0 0 '+(h*i).toString()+'px;display:inline-block;"><!----></p>',n+=o,n+=v?"<span style='color: green;'>&lt;!--"+trim(u[r].nodeValue)+"--&gt;</span>":"<span style='color: green;'>&lt;!--"+u[r].nodeValue+"--&gt;</span>";else if(u[r].nodeName=="#cdata-section")alert("cd data");else if(u[r].nodeName!="#document-fragment"&&u[r].nodeName!="#document"&&u[r].tagName!="undefined"&&trim(u[r].tagName)!="")if((u[r].tagName.toUpperCase()=="INPUT"&&u[r].type=="text"||u[r].tagName.toUpperCase()=="TEXTAREA")&&u[r].removeAttribute("readOnly"),/[\r\n|\n|\r]+$/.exec(n)||(n+="<br>"),o='<p style="margin:0 0 0 '+(h*i).toString()+'px;display:inline-block;"><!----></p>',n+=o,u[r].tagName=="IMG"||u[r].tagName=="INPUT"||u[r].tagName=="BR"){var f=trim(getOuterHTML(u[r])),s=f.substring(0,f.indexOf(">")+1),c=ScriptFormatter.colorTagStart(u[r].tagName,s);n+=c}else u[r].tagName=="SCRIPT"?(f=trim(getOuterHTML(u[r])),f&&f!=""&&f.indexOf(">")!=-1&&(s=f.substring(0,f.indexOf(">")+1),c=ScriptFormatter.colorTagStart(u[r].tagName,s),n+=trim(c)+"<br>",n=n.replace(/([ \t]+)(<SCRIPT)/gi,"$2"),e=f.substring(f.indexOf(">")+1),e=e.replace(/<\/SCRIPT>/i,""),e=ScriptFormatter.formatScriptCode(e,!0),a='<p style="margin:0 0 0 '+h.toString()+'px;display:inline-block;"><!----></p>',e=e.replace(/[\t]/g,a),e=e.replace(/[\n]/g,"<br>"),e=e.replace(/<br>/gi,"</span><br><span style='color:green;'>"),n+="<span style='color: green;'>"+e.replace("<","&lt;").replace(">","&gt;")+"</span>",/[\r\n|\n|\r]+$/.exec(n)||(n+="<br>"),n+="&lt;/<span style='color: brown;'>"+trim(u[r].tagName.toLowerCase())+"</span>&gt;")):(f=trim(getOuterHTML(u[r])),f&&f!=""&&f.indexOf(">")!=-1&&(s=f.substring(0,f.indexOf(">")+1),c=ScriptFormatter.colorTagStart(u[r].tagName,s),n+=c,n=ScriptFormatter.textmakeIndentWithColor(n,u[r],i),/[\r\n|\n|\r]+$/.exec(n)||(n+="<br>"),o='<p style="margin:0 0 0 '+(h*i).toString()+'px;display:inline-block;"><!----></p>',n+=o,n+="&lt;/<span style='color: brown;'>"+trim(u[r].tagName.toLowerCase())+"</span>&gt;"));return n},w=function(n,t){for(var r=ScriptFormatter.getAttributes(t),u="&lt;<span style='color: brown;'>"+n.toLowerCase()+"</span>",i=0;i<r.length;i++)u+=r[i].value!=""?" <span style='color: red;'>"+r[i].name+"</span>=<span style='color: blue;'>\""+r[i].value+'"</span>':" <span style='color: blue;'>"+r[i].name+"</span>";return u+="&gt;"},v=function(n){for(var u=n,i=[],e=/([^\s]+)([ \t]*=[ \t]*)(\'[^\']+\'|\"[^\"]+\"|[^\s]+)/g,t=0,f,o,r;match=e.exec(u);)match[3]&&match[3]!=""&&(i[t]=[],i[t].name=match[1],i[t].value=match[3].replace(/^[\'\"]|[\'\"]$/g,""),t++);for(t>0&&(u=u.replace(/([^\s]+)([ \t]*=[ \t]*)(\'[^\']*\'|\"[^\"]*\"|[^\s]+)/g,"")),f=[],o=0,e=/([^=][ \t]+)(\"[^\"]+\")/g;match=e.exec(u);)f[o]=[],f[o].name=match[2],f[o].value="",o++;for(u=u.replace(/([^=][ \t]+)(\"[^\"]+\")/g,"$1"),e=/([ \t]+)([^<> \t]+)/g;match=e.exec(u);)i[t]=[],i[t].name=match[2],i[t].value="",t++;for(r=0;r<f.length;r++)i[t+r]=[],i[t+r].name=f[r].name,i[t+r].value="";return i},c=function(o,c){var v=o,l=0,a;switch("regComFrom"+c){case"regComFrom1":while(match=d.exec(o))a=match[1]+match[2],t[l]=a,v=v.replace(a,"<COMM1"+l+">"),l++;break;case"regComFrom2":while(match=g.exec(o))a=match[1]+match[2]+match[3],i[l]=a,v=v.replace(a,"<COMM2"+l+">"),l++;break;case"regComFrom3":while(match=s.exec(o))a=match[3]+match[4]+match[5]+match[6],n[l]=a,v=v.replace(a,"<COMM3"+l+">"),l++;break;case"regComFrom4":while(match=k.exec(o))a=match[3]+match[4]+match[5]+match[6],r[l]=a,v=v.replace(a,"<COMM4"+l+">"),l++;break;case"regComFrom5":while(match=b.exec(o))a=match[1]+match[2]+match[3]+match[4],e[l]=a,v=v.replace(a,"<COMM5"+l+">"),l++;break;case"regComFrom6":while(match=h.exec(o))a=match[3],f[l]=a,v=v.replace(a,"<COMM6"+l+">"),l++;break;case"regComFrom7":while(match=nt.exec(o))a=match[3],u[l]=a,v=v.replace(a,"<COMM7"+l+">"),l++}return v},l=function(o,s){var c=o,h;switch("arCom"+s){case"arCom1":for(h=0;h<t.length;h++)c=c.replace("<COMM"+s.toString()+h.toString()+">",t[h]);break;case"arCom2":for(h=0;h<i.length;h++)c=c.replace("<COMM"+s.toString()+h.toString()+">",i[h]);break;case"arCom3":for(h=0;h<n.length;h++)c=c.replace("<COMM"+s.toString()+h.toString()+">",n[h]);break;case"arCom4":for(h=0;h<r.length;h++)c=c.replace("<COMM"+s.toString()+h.toString()+">",r[h]);break;case"arCom5":for(h=0;h<e.length;h++)c=c.replace("<COMM"+s.toString()+h.toString()+">",e[h]);break;case"arCom6":for(h=0;h<f.length;h++)c=c.replace("<COMM"+s.toString()+h.toString()+">",f[h]);break;case"arCom7":for(h=0;h<u.length;h++)c=c.replace("<COMM"+s.toString()+h.toString()+">",u[h])}return c},a=function(n,t){var s=indtWidthForText,o,r,h;t&&(s="\t"),n=n.replace(/(\n)([ \t]*)/g,"$1"),n=n.replace(/([ \t]*)([\n{};])([ \t]*)/g,"$2");var l=/(.*?)([\n{};])/g,a=[],c="",e=[];e[0]="";for(var f=0,u="",h="none",i=[];i=l.exec(n);)u+=i[2]=="\n"?i[1]!=""&&/^[^<]/.exec(i[1])&&(/[{]$/.exec(u)||/[}]$/.exec(u)||/[;]$/.exec(u))?"\n"+i[1]+i[2]:i[1]+i[2]:i[1]!=""?/^[<]/.exec(i[1])?i[1]+i[2]:/[\n]$/.exec(u)?i[1]+i[2]:"\n"+i[1]+i[2]:/[{]$/.exec(u)&&/^[}]/.exec(i[2])?i[2]:/[}]$/.exec(u)&&/^[;]/.exec(i[2])?i[2]:/[{]$/.exec(u)&&/^[;]/.exec(i[2])?i[2]:"\n"+i[2];for((i=/([\n{};])([^\n{};]+)$/.exec(n))&&(u+=i[2]),o=/(.*?)([\n{}])/g,r="",f=0,h="";i=o.exec(u);){if(i[2]=="\n")r+=trim(i[1])+i[2]+e[f];else if(i[2]=="{")f++,e.length==f&&(c+=s,e[f]=c),r+=trim(i[1])+i[2];else if(i[2]=="}")if(f>0&&f--,i[1]!="")r+=trim(i[1])+i[2];else{if(t)while(mch=/(\n)([\t]+?)$/.exec(r))r=r.replace(/(\n)([\t]+?)$/,"");else while(mch=/(\n)([ ]+?)$/.exec(r))r=r.replace(/(\n)([ ]+?)$/,"");r+="\n"+e[f]+trim(i[1])+i[2]}h=i[2]}for((i=/([\n{}])([^\n{}]+)$/.exec(u))&&(r+=i[2]),r=r.replace(/(})([\s]*)(;)/g,"$1$3"),r=r.replace(/(})([\s]*)(,)/g,"$1$3"),r=r.replace(/([)])([\s]*)([{])/g,"$1$3");i=/([\s])(for)([ \t]*?[\(])(.*?)(;\n)([ \t]*?)([^ \t])/i.exec(r);)r=r.replace(/([\s])(for)([ \t]*?[\(])(.*?)(;\n)([ \t]*?)([^ \t])/i,"$1$2$3$4;$7");return r=r.replace(/([>{}();,][\n])([ \t]+[\n])+([ \t]+[^\n{};])/g,"$1$3"),r=r.replace(/([>{}();,][\n])([\n])+([^\n{};])/g,"$1\n$3"),r=r.replace(/([})])([\n])([ \t]*?)([);,])/g,"$1$4"),r=r.replace(/(})([\n][ \t]*)(else)/g,"$1$3")},o=function(n,t){return n=n.replace(/^([\s]*)(.*)/,"$2"),n=n.replace(/([^\\])(\")/g,"$1 $2"),n=n.replace(/([^\\])(\')/g,"$1 $2"),n=ScriptFormatter.regCommFrom(n,"6"),n=ScriptFormatter.regCommFrom(n,"3"),n=ScriptFormatter.regCommFrom(n,"7"),n=ScriptFormatter.regCommFrom(n,"4"),n=ScriptFormatter.regCommFrom(n,"2"),n=ScriptFormatter.regCommFrom(n,"1"),n=ScriptFormatter.regCommFrom(n,"5"),n=n.replace(/[&]/g,"&amp"),n=n.replace(/[<]/g,"&lt"),n=n.replace(/[>]/g,"&gt"),n=ScriptFormatter.makItIndent(n,t),n=n.replace(/(&gt)/g,">"),n=n.replace(/(&lt)/g,"<"),n=n.replace(/(&amp)/g,"&"),n=ScriptFormatter.regCommTo(n,"5"),n=ScriptFormatter.regCommTo(n,"1"),n=ScriptFormatter.regCommTo(n,"2"),n=ScriptFormatter.regCommTo(n,"4"),n=ScriptFormatter.regCommTo(n,"7"),n=ScriptFormatter.regCommTo(n,"3"),n=ScriptFormatter.regCommTo(n,"6"),n=n.replace(/( )(\')/g,"$2"),n=n.replace(/( )(\")/g,"$2"),n=trim(n)};this.ScriptFormatter||(ScriptFormatter={textmakeIndent:y,textmakeIndentWithColor:p,colorTagStart:w,getAttributes:v,formatScriptCode:o,makItIndent:a,regCommTo:l,regCommFrom:c})})(),function(){var t=0,n=0,s=function(i,r){var e,o,u,f;this.hideMenus(),i=i?i:event?event:null,i&&(e=i.target?i.target:i.srcElement,(e.className=="spanForOgMenu"||e.className=="imgNextMenuForOgMenu")&&(e=e.parentNode),o="menuFor_"+r.toLowerCase(),u=document.getElementById(o),u!=undefined&&(u.setCapture&&u.setCapture(),t=0,n=0,f=this.getCurPosition(i),t=f.left,n=f.top,u.style.left=f.left+"px",u.style.top=f.top+"px",u.style.visibility="visible"),i.preventDefault&&i.preventDefault(),i.returnValue=!1)},o=function(){var t,n;document.releaseCapture&&document.releaseCapture();for(t in ogMenu)n=document.getElementById(ogMenu[t].menuID),n.style.visibility="hidden"},h=function(n){if(n=n?n:event?event:null,n){var t=n.target?n.target:n.srcElement;(t.className=="spanForOgMenu"||t.className=="imgNextMenuForOgMenu")&&(t=t.parentNode),t.className.indexOf("menuItem")!=-1&&(t.className="menuItem"),n.preventDefault&&n.preventDefault(),n.returnValue=!1}},l=function(i){var r,h,s,f,u,e;if(i=i?i:event?event:null,i){if(r=i.target?i.target:i.srcElement,(r.className=="spanForOgMenu"||r.className=="imgNextMenuForOgMenu")&&(r=r.parentNode),r.className.indexOf("menuItem")!=-1&&(r.className="menuItemOn",h=r.id+"_sub",s=r.id.split("_"),s.length==2))for(f=RClickMenus.getElementsByClassName("ogContextMenus_sub"),u=0;u<f.length;u++)if(f[u].id==h){if(f[u]){e=f[u],r.setCapture&&r.setCapture();var o={left:0,top:0},a=r.offsetWidth,l=r.offsetHeight,c=l*(parseInt(s[1],10)-1),v=$("edit_iframe"+curScreenId.toString()).contentWindow.document;o.left=t+a,o.top=n+c,e.style.left=o.left+"px",e.style.top=o.top+"px",e.style.visibility="visible"}}else f[u]&&(f[u].style.visibility="hidden");i.preventDefault&&i.preventDefault(),i.returnValue=!1}},c=function(n){if(n=n?n:event?event:null,n){var t=n.target?n.target:n.srcElement;(t.className=="spanForOgMenu"||t.className=="imgNextMenuForOgMenu")&&(t=t.parentNode),t.className=="menuItemOn",this.hideMenus()}},r=function(n){var i,t;for(i in ogMenu)if(ogMenu[i].menuID==n.parentNode.id)for(t=0;t<ogMenu[i].menuItems.length;t++)if(n.firstChild.nodeValue==ogMenu[i].menuItems[t].label)return ogMenu[i].menuItems[t].href;return""},i=function(n){var t={left:0,top:0},i=$("edit_iframe"+curScreenId.toString()).contentWindow;return n.pageX?isFirefox?(t.left=n.pageX-i.pageXOffset,t.top=n.pageY-i.pageYOffset):(t.left=n.pageX-i.document.body.scrollLeft-i.document.body.clientLeft,t.top=n.pageY-i.document.body.scrollTop-i.document.body.clientTop):n.clientX&&(t.left=n.clientX,t.top=n.clientY),t},u=function(n){for(var i=document.all?document.all:document.getElementsByTagName("*"),r=[],u=new RegExp("\\b"+n+"\\b"),t=0;t<i.length;t++)u.test(i[t].className)&&r.push(i[t]);return r},e=function(n){for(var i=RClickMenus.getElementsByClassName("imgNextMenuForOgMenu"),t=0;t<i.length;t++)i[t].src=n+"img/nextMenu.gif"},f=function(){var t,s,r,i,c,h,u,f,e,n,o;for(n in ogMenu){for(t=ogMenu[n],s=document.createElement("ul"),s.id=t.menuID,s.className=t.classID,i=0;i<t.menuItems.length;i++)r=document.createElement("li"),r.className="menuItem",r.id=t.menuItems[i].id,t.menuItems[i].click!=""?(c='<span class="spanForOgMenu" onclick="'+t.menuItems[i].click+'" >'+t.menuItems[i].label+"</span>",r.innerHTML=c):(h=document.createElement("span"),h.className="spanForOgMenu",h.innerHTML=t.menuItems[i].label,r.appendChild(h),u=document.createElement("img"),u.className="imgNextMenuForOgMenu",f=pathToOgEditor,f=f=="/"?"":f.replace(/\/$/,""),u.src=f+"/img/nextMenu.gif",u.height="13",u.width="10",r.appendChild(u)),s.appendChild(r);document.body.appendChild(s)}for(e=this.getElementsByClassName("ogContextMenus"),n=0;n<e.length;n++)addEvent(e[n],"click",function(){RClickMenus.hideMenus()},!1),addEvent(e[n],"mouseup",function(n){RClickMenus.itemClicked(n)},!1),addEvent(e[n],"mouseover",RClickMenus.ogMenuItemMOver,!1),addEvent(e[n],"mouseout",RClickMenus.ogMenuItemMOut,!1);for(o=this.getElementsByClassName("ogContextMenus_sub"),n=0;n<o.length;n++)addEvent(o[n],"click",function(){RClickMenus.hideMenus()},!1),addEvent(o[n],"mouseup",function(n){RClickMenus.itemClicked(n)},!1),addEvent(o[n],"mouseover",RClickMenus.ogMenuItemMOver,!1),addEvent(o[n],"mouseout",RClickMenus.ogMenuItemMOut,!1)};this.RClickMenus||(RClickMenus={createOgMenus:f,getElementsByClassName:u,getCurPosition:i,getHref:r,itemClicked:c,setImgSrcForNextMenu:e,ogMenuItemMOver:l,ogMenuItemMOut:h,hideMenus:o,addEvent:addEvent,showMenu:s})}(),ogMenu={},ogMenu.dialgTable_sub_01={menuID:"menuItem_5_sub",classID:"ogContextMenus_sub",menuItems:[{label:"Insert Row Before",id:"menuItem_5_item1",click:"tblInsertRow('before');"},{label:"Insert Row After",id:"menuItem_5_item2",click:"tblInsertRow('after');"},{label:"Merge Down",id:"menuItem_5_item3",click:"tblMergeDown();"},{label:"Delete Row",id:"menuItem_5_item4",click:"tblDeleteRow();"}]},ogMenu.dialgTable_sub_02={menuID:"menuItem_6_sub",classID:"ogContextMenus_sub",menuItems:[{label:"Insert Cell Before",id:"menuItem_6_item1",click:"tblInsertCell('before');"},{label:"Insert Cell After",id:"menuItem_6_item2",click:"tblInsertCell('after');"},{label:"Merge Right",id:"menuItem_6_item3",click:"tblMergeRight();"},{label:"Delete Cell",id:"menuItem_6_item4",click:"tblDeleteCell();"}]},ogMenu.dialgTable_sub_03={menuID:"menuItem_4_sub",classID:"ogContextMenus_sub",menuItems:[{label:"On",id:"menuItem_4_item1",click:"showOrHideGuides('true');"},{label:"Off",id:"menuItem_4_item2",click:"showOrHideGuides('false');"}]},ogMenu.dialgTable={menuID:"menuFor_table",classID:"ogContextMenus",menuItems:[{label:"Cut",id:"menuItem_1",click:"execCmd('cut',null,null);"},{label:"Copy",id:"menuItem_2",click:"copyToWebClipBoard();"},{label:"Paste",id:"menuItem_3",click:"paste();"},{label:"Visual Aid",id:"menuItem_4",click:""},{label:"Row",id:"menuItem_5",click:""},{label:"Cell",id:"menuItem_6",click:""}]},ogMenu.general={menuID:"menuFor_general",classID:"ogContextMenus",menuItems:[{label:"Cut",id:"menuItem_1",click:"execCmd('cut',null,null);"},{label:"Copy",id:"menuItem_2",click:"copyToWebClipBoard();"},{label:"Paste",id:"menuItem_3",click:"paste();"},{label:"Visual Aid",id:"menuItem_4",click:""}]},addEvent(window,"load",load)