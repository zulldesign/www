var isFirefox=navigator.userAgent.indexOf("Firefox")!=-1?!0:!1,isIE=navigator.appName=="Microsoft Internet Explorer"?!0:!1,isChrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,isOpera=navigator.userAgent.toLowerCase().indexOf("opera")+1?1:0,LoadCss,LoadScript;isOpera&&(isIE=!1);var isSafari=navigator.appVersion.toLowerCase().indexOf("safari")+1?1:0,makeRelativePath=function(n,t){var i="",r;if(t.indexOf(n)==0)i=t.replace(n,"");else{for(r=/(\/)/g;match=r.exec(n);)i+="../";i+=t.replace(/^\//,"")}return i.replace(/^\//,"")},relativePath=makeRelativePath(pathToYourEditorFolder,pathToOgEditor);relativePath&&(relativePath!=""||relativePath!="/")&&(relativePath=relativePath+"/"),LoadCss=function(n){document.write('<link href="'+relativePath+n+'" rel="stylesheet" type="text/css">')},LoadScript=function(n){document.write('<script type="text/javascript" src="'+relativePath+n+'"><\/script>')},isFullScreen&&LoadCss("css/fullscreen.css"),isIE?(LoadCss("css/dialog_ie.css"),LoadCss("css/menu_ie.css"),LoadCss("css/main.css")):(LoadCss("css/dialog.css"),LoadCss("css/menu.css"),LoadCss("css/main.css")),function(){var g="ogEditor_newControl_3fh8c76frtuf0s3",ge=.7,ei=.4,c=97,w,o,lt,at;if(isFullScreen?(c=75,isIE&&(c-=7),w=2,isChrome&&(w=5,c-=1)):(isIE&&(c-=24),w=2,isChrome&&(w=5,c-=1)),o="",location.search.length>1){lt=location.search.substr(1).split("&");for(idx in lt)at=lt[idx].split("="),at[0]=="user"&&(o=at[1])}o==""&&window.close();var si=",open,new,save,",de=",dialgFormatConfirm,dialgColoredHtmlConfirm,dialgOpen,dialgNew,dialgSaveAs,dialgFolderBrowser,dialgFileBrowser,dialgNewFolder,",to=/[\\\/:\*\?<>|]/,yt=!1,pt=!1,oh=[],sh=[],eh=[],uh=[],hh=[],no=[],a=[],rt=-1,t=0,e=[],v=[],ut=DefaultEncoding,ph=/([^<]*)(<head)([^<]+)(<\/head>)([^<]*)(<body)([^<]+)(<\/body>)([^<]*)/gi,wh=/(<script)([^<]+)(<\/script>)/gi,bh="<!-- Js-Tag-Repl-Com -->",n=function(n){return document.getElementById(n)},yh=function(n,t){return t.getElementsByTagName(n)},lh="",ah=800,fh=1,vh='<span id="spacer_w10"style="margin:10;"></span>',hi=66.5,k=0,tt=0,y=0,nt=0,i=-1,f=-1,et=-1,ht=150,fi=0,ri=0,ti=0,ii=0,h,we=0,ft,s="",p="",gt=function(){this.path=n("folderLoc").value,this.fName=n("fName").value,this.enc=n("fEnc").value,this.ret=n("fRet").value,this.validate_to_SaveAs=function(){var i=to.exec(this.fName),t;if(i){alert("Cannot use the following characters for file name!\n / : * ? < > |"),n("fName").focus();return}if(t=OgEditor.getFileExtension(this.fName),acceptExtension.indexOf(","+t+",")<0){alert("Upload denied. This file extension is forbidden!"),n("fName").focus();return}n("common").contentWindow.validate_to_SaveAs(this.path,this.fName)},this.saveAs=function(i){var c=n("edit_iframe"+t.toString()).contentWindow.getContentsForSave(),o=!1,u,r,h,s;if(i=="true")if(confirm("The filename file already exists. Do you want to overwrite it?")){for(u=(this.path=="/"?this.path:this.path+"/")+this.fName,r=0;r<e.length;r++)if(e[r]==u)if(r==f)o=!0;else if(h=OgEditor.getDirFromFilePath(u),s=OgEditor.setActiveFlder(h),s)OgEditor.setActive(r),OgEditor.waitAndOpenFile(wt(c),this.fName),OgEditor.showOrHideFuncBtns(r),n("edit_iframe"+t.toString()).contentWindow.RClickMenus.hideMenus(),n("edit_iframe"+t.toString()).contentWindow.addOnclickEventToChilds(),OgEditor.clearAttriCssPane(),OgEditor.getInternalStyles(),o=!0;else{alert("An error has occured Please contact your system admin.  error code: A0001");return}}else return;et=f,n("common").contentWindow.saveAs_to_refreshAndOpenDir(this.path,this.fName,this.enc,this.ret,c),OgEditor.closeDialog(),o||(OgEditor.closeTab(f),alert("Document was successfully saved and closed."))}},pe=function(){if(isDemo){alert("Demo version does not allow file saving."),OgEditor.closeDialog();return}ft=new gt,ft.validate_to_SaveAs()},ke=function(n){ft.saveAs(n),delete ft},be=function(n,t){return t.join(",").indexOf(n)>=0?!0:!1},io=function(n,t,r,u){i>=0||n=="dialgOpen"||n=="dialgOpenForIE"||n=="dialgPlus"||n=="dialgNew"||n=="dialgNewFolder"||n=="dialgAbout"?(u&&u=="cctrl"?OgEditor.showDialg("dialgCctrl",n,r):OgEditor.showDialg(n,t,r),s="ogEditorDialog"):alert("No file is selected!")},so=function(){var t=document.body.innerHTML;p=t,OgEditor.openDialog("dialgFormatConfirm",null,"Auto format Confirmation",null);return},oo=function(){var i=n("target_area").value;n("edit_iframe"+t.toString()).contentWindow.applyFormatterResult(i),v[f]="source",OgEditor.showOrHideFuncBtns(f),OgEditor.closeDialog()},co=function(n){p=n,OgEditor.openDialog("dialgFormatConfirm",null,"Auto format Confirmation",null)},ho=function(n){p=n,OgEditor.openDialog("dialgColoredHtmlConfirm",null,"Tag highlighter Confirmation",null)},uo=function(i,r,u){var h,c,f,e,s,o;de.indexOf(","+i+",")<0&&n("edit_iframe"+t.toString())&&n("edit_iframe"+t.toString()).contentWindow.findRange(),n("ogEditor_transDiv")||OgEditor.createDivs(),n("ogEditor_transDiv").style.zIndex=9e4,n("ogEditor_transDiv").style.display="block",n("ogEditorDialog").style.zIndex=97e3,n("ogEditorDialog").style.display="block",n("ogEditorDialog_sub").style.zIndex=98e3,n("ogEditorDialog_sub_sub").style.zIndex=99e3,navigator.userAgent.indexOf("MSIE")>-1?n("ogEditorDialog_lblTitle").innerText=u:n("ogEditorDialog_lblTitle").textContent=u,h=n("iDialog").contentWindow.document,c=h.getElementById(i).innerHTML,n("ogEditorDialog_content").innerHTML=c,f=OgEditor.getOffset(n("ogEditor_container")),e=(n("ogEditor_container").offsetWidth-n("ogEditorDialog").offsetWidth)/2,isFirefox?(n("ogEditorDialog").style.top=n("ogEditor_navigationLink").offsetHeight+10+f.top+document.body.clientTop+"px",n("ogEditorDialog").style.left=e+f.left+document.body.clientLeft+"px"):(n("ogEditorDialog").style.top=n("ogEditor_navigationLink").offsetHeight+10+f.top+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)+document.body.clientTop+"px",n("ogEditorDialog").style.left=e+f.left+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)+document.body.clientLeft+"px"),s=n(i+"_btnCancel"),OgEditor.addEvent(s,"click",OgEditor.closeDialog),o=n("ogEditorDialog"),OgEditor.openDialogSuccessed(o,i,r)},ro=function(t,i,r){var u,f,h,c,e,o;n("ogEditor_transDiv").style.zIndex=97500,n("ogEditorDialog_sub").style.display="block",u=OgEditor.getOffset(n("ogEditor_container")),f=(n("ogEditor_container").offsetWidth-n("ogEditorDialog").offsetWidth)/2,isFirefox?(n("ogEditorDialog_sub").style.top=n("ogEditor_navigationLink").offsetHeight+20+u.top+document.body.clientTop+"px",n("ogEditorDialog_sub").style.left=f+10+u.left+document.body.clientLeft+"px"):(n("ogEditorDialog_sub").style.top=n("ogEditor_navigationLink").offsetHeight+20+u.top+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)+document.body.clientTop+"px",n("ogEditorDialog_sub").style.left=f+10+u.left+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)+document.body.clientLeft+"px"),navigator.userAgent.indexOf("MSIE")>-1?n("ogEditorDialog_lblTitle_sub").innerText=r:n("ogEditorDialog_lblTitle_sub").textContent=r,h=n("iDialog").contentWindow.document,c=h.getElementById(t).innerHTML,n("ogEditorDialog_content_sub").innerHTML=c,e=n(t+"_btnCancel"),OgEditor.addEvent(e,"click",OgEditor.closeDialog),s="ogEditorDialog_sub",o=n("ogEditorDialog_sub"),OgEditor.openDialogSuccessed(o,t,i)},eo=function(t,i,r){var u,f,h,c,e,o;n("ogEditor_transDiv").style.zIndex=98500,n("ogEditorDialog_sub_sub").style.display="block",u=OgEditor.getOffset(n("ogEditor_container")),f=(n("ogEditor_container").offsetWidth-n("ogEditorDialog").offsetWidth)/2,isFirefox?(n("ogEditorDialog_sub_sub").style.top=n("ogEditor_navigationLink").offsetHeight+30+u.top+document.body.clientTop+"px",n("ogEditorDialog_sub_sub").style.left=f+20+u.left+document.body.clientLeft+"px"):(n("ogEditorDialog_sub_sub").style.top=n("ogEditor_navigationLink").offsetHeight+30+u.top+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)+document.body.clientTop+"px",n("ogEditorDialog_sub_sub").style.left=f+20+u.left+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)+document.body.clientLeft+"px"),navigator.userAgent.indexOf("MSIE")>-1?n("ogEditorDialog_lblTitle_sub_sub").innerText=r:n("ogEditorDialog_lblTitle_sub_sub").textContent=r,h=n("iDialog").contentWindow.document,c=h.getElementById(t).innerHTML,n("ogEditorDialog_content_sub_sub").innerHTML=c,e=n(t+"_btnCancel"),OgEditor.addEvent(e,"click",OgEditor.closeDialog),s="ogEditorDialog_sub_sub",o=n("ogEditorDialog_sub_sub"),OgEditor.openDialogSuccessed(o,t,i)},fo=function(i,r,u){var ot,ct,w,y,lt,b,et,d,c,tt,k,v,it,at,nt,l,s,g,st;if(r=="dialgSaveAs")ot=e[f],a[t]!=undefined&&(n("folderLoc").value=a[t]),ct=ot.replace(/(.*)?(\/)([^\/]+)$/,"$3"),n("fName").value=ct,i.style.width="550px";else if(r=="dialgCctrl"){for(n("dialgCctrlType").value=u,c=ogCControl[u],w="<legend>General</legend>",s=0;s<c.ogCCGeneral.length;s++){var h=c.ogCCGeneral[s].attribute,rt=c.ogCCGeneral[s].desc,ft=c.ogCCGeneral[s].value,ht=c.ogCCGeneral[s].require;ht=="true"?(w+='<label for="txt'+h+'" class="label-txt" title="'+rt+'"><b>'+h+":</b></label>",w+='<input class="ogEditorDialogTxtfield" name="txt'+h+'" type="text" id="txt'+h+'" value="'+ft+'" /><br>'):(w+='<label for="txt'+h+'" class="label-txt" title="'+rt+'">'+h+":</label>",w+='<input class="ogEditorDialogTxtfield" name="txt'+h+'" type="text" id="txt'+h+'" value="'+ft+'" /><br>')}for(n("ogEditorCCtrlGeneral").innerHTML=w+"<br>",y="<legend>Details</legend>",s=0;s<c.ogCCDetails.length;s++){var h=c.ogCCDetails[s].attribute,rt=c.ogCCDetails[s].desc,ft=c.ogCCDetails[s].value,ht=c.ogCCDetails[s].require;ht=="true"?(y+='<label for="txt'+h+'" class="label-txt" title="'+rt+'"><b>'+h+":</b></label>",y+='<input class="ogEditorDialogTxtfield" name="txt'+h+'" type="text" id="txt'+h+'" value="'+ft+'" /><br>'):(y+='<label for="txt'+h+'" class="label-txt" title="'+rt+'">'+h+":</label>",y+='<input class="ogEditorDialogTxtfield" name="txt'+h+'" type="text" id="txt'+h+'" value="'+ft+'" /><br>')}n("ogEditorCCtrlDetails").innerHTML=y+"<br>",n("edit_iframe"+t.toString()).contentWindow.findRange()}else if(r=="dialgFormatConfirm")n("target_area").value=p,i.style.width="600px";else if(r=="dialgWordCount")n("dialgWordCount_general").innerHTML=p,i.style.width="350px";else if(r=="dialgColoredHtmlConfirm")n("divHtml").innerHTML=p,n("target_area").value=p,i.style.width="600px";else if(r=="dialgOpen")for(window.File&&window.FileList&&window.FileReader&&(lt=n("selectFiles"),OgEditor.addEvent(lt,"change",OgEditor.fileDripped,!1)),s=0;s<n("fEnc").length;s++)n("fEnc").options[s].value==ut&&(n("fEnc").selectedIndex=s);else if(r=="dialgOpenForIE")for(n("filOpenForIE").src=relativePath+"fileOpenForIE.aspx",s=0;s<n("fEnc").length;s++)n("fEnc").options[s].value==ut&&(n("fEnc").selectedIndex=s);else if(r=="dialgNew"){for(i.style.width="450px",b=document.createElement("div"),b.className="ogTempArea",s=0;s<templates.length;s++)v=templates[s].name,et=document.createElement("div"),et.className="ogTempBox",et.innerHTML="<a href=\"javascript:OgEditor.templateSelected('"+v+'\');" ><img src="'+relativePath+"template/img/"+v+'.jpg" width="180px;"></a><br>'+v,b.insertBefore(et,b.firstChild);n("dialogNew_templates").appendChild(b)}else if(r=="dialgCCtrlList"){i.style.width="450px",d=document.createElement("div"),d.className="ogTempArea";for(s in ogCControl)c=ogCControl[s],tt=document.createElement("div"),tt.className="ogTempBox",tt.innerHTML="<a href=\"javascript:OgEditor.cctrlSelected('"+c.name+'\');" ><img src="'+relativePath+"cctrl/img/"+c.name+'.jpg" width="180px;"></a><br>'+c.name,d.insertBefore(tt,d.firstChild);n("dialgCCtrlList_chart").appendChild(d)}else if(r=="dialgComponent"){for(i.style.width="450px",k=document.createElement("div"),k.className="ogTempArea",s=0;s<components.length;s++)v=components[s].name,it=document.createElement("div"),it.className="ogTempBox",it.innerHTML="<a href=\"javascript:OgEditor.componentSelected('"+v+'\');" ><img src="'+relativePath+"component/img/"+v+'.jpg" width="180px;"></a><br>'+v,k.insertBefore(it,k.firstChild);n("dialogComponent_patterns").appendChild(k)}else if(r=="dialgNewFolder")n("newFolderBrowser").src=relativePath+"browser.aspx?browse=folder&edIgnore=yes&user="+o;else if(r=="dialgFolderBrowser"&&n(u).value!="")n("folderBrowser").src=relativePath+"browser.aspx?edIgnore=yes&browse=folder&user="+o,at=n(u).value,n("folderBrowserFolderPath").value=at;else if(r=="dialgImage")n("edit_iframe"+t.toString()).contentWindow.findRange(),i.style.width="630px";else if(r=="dialgFileBrowser")n("fileBrowser").src=relativePath+"browser.aspx?fileType=image&edIgnore=yes&refFileType=image&user="+o;else if(r=="dialgImageUpload")n("filUpload").src=relativePath+"fileUpload.aspx?user="+o+"&ext=image",n("newFolderBrowser").src=relativePath+"browser.aspx?edIgnore=yes&browse=folder&user="+o,n("edit_iframe"+t.toString()).contentWindow.findRange(),i.style.width="450px";else if(r=="dialgUpload")n("filUpload").src=relativePath+"fileUpload.aspx?user="+o,n("newFolderBrowser").src=relativePath+"browser.aspx?edIgnore=yes&browse=folder&user="+o,n("edit_iframe"+t.toString()).contentWindow.findRange(),i.style.width="450px";else if(r=="dialgTable")n("edit_iframe"+t.toString()).contentWindow.findRange(),i.style.width="450px";else if(r=="dialgFind")n("edit_iframe"+t.toString()).contentWindow.findRange();else if(r=="dialgAbout")n("ogEditorLogo").src=relativePath+companyLogo;else if(r=="dialgColor"){if(n("dialgColorText").value="",u=="fontcolor"){if(nt=n("edit_iframe"+t.toString()).contentWindow.getSelectedText(),nt=="")return;n("dialgColorText").value=nt}else u=="backcolor"&&(nt=n("edit_iframe"+t.toString()).contentWindow.getSelectedText(),n("dialgColorText").value=nt);i.style.width="450px",document.formDialgColor.dialgColorSrc.value=u}else if(r=="dialgLink")if(l=n("edit_iframe"+t.toString()).contentWindow.getExistingLinkAttr(),l.length>0){for(s=0;s<l.length;s++)switch(l[s].name){case"href":n("txtUrl").value=l[s].value;break;case"title":n("txtTitle").value=l[s].value;break;case"id":n("txtID").value=l[s].value;break;case"name":n("txtName").value=l[s].value;break;case"class":n("txtClass").value=l[s].value;break;case"style":n("txtStyle").value=l[s].value;break;case"target":n("txtTarget").value=l[s].value;break;case"tabindex":n("txtTabIndex").value=l[s].value;break;case"accesskey":n("txtAccessKey").value=l[s].value}n("txtText").value=n("edit_iframe"+t.toString()).contentWindow.getExistingLinkInnerHtml()}else g=n("edit_iframe"+t.toString()).contentWindow.getSelectedHtml(),st=/(.*<[Ii][Mm][Gg].*)/,st.test(g)&&(g=g.replace(/(.*<A[^<]*)(<IMG[^<]*).*$/i,"$2")),n("txtText").value=g;r!="dialgOpen"&&r!="dialgNew"&&n("edit_iframe"+t.toString()).contentWindow.focusEditScreen()},re=function(t){n("fileLoc").value=t,OgEditor.closeDialog()},ie=function(){n("ogEditorDialog_sub_sub").style.display="none",n("ogEditor_transDiv").style.zIndex=97500,n("folderBrowser")&&n("folderBrowser").contentWindow.refreshWindow(),s="ogEditorDialog_sub"},fe=function(){var u=n("keyword").value,r=n("caseSensitive").checked==!0,i=n("backwards").checked==!0;n("edit_iframe"+t.toString()).contentWindow.findNext(u,r,i)},ue=function(){var u=n("keyword").value,f=n("replaceWith").value,i=n("caseSensitive").checked==!0,r=n("backwards").checked==!0;n("edit_iframe"+t.toString()).contentWindow.replaceWith(u,f,i,r)},gf=function(){var u=n("keyword").value,f=n("replaceWith").value,i=n("caseSensitive").checked==!0,r=n("backwards").checked==!0;n("edit_iframe"+t.toString()).contentWindow.replaceAll(u,f,i,r)},df=function(t,i){for(var s=i.split("_")[0],h=n(s+"_top"),f=h.childNodes,o,e,u,r=0;r<f.length;r++)f[r].id!=undefined&&(f[r].id==i?f[r].style.display="":f[r].id.indexOf(s)==0&&(f[r].style.display="none"));if(o=n(t),o&&o.tagName=="UL")for(e=o.childNodes,u=0;u<e.length;u++)e[u].id=e[u].id=="onlink"?"":"onlink"},te=function(){var i=document.formDialgTable,r='\n<table id="'+g+'" ',u,o,s,f,e;for(i.tblWidth.value!=""&&(r+=OgEditor.addAttribute("width",i.tblWidth.value+i.optWidth.value)),i.tblHeight.value!=""&&(r+=OgEditor.addAttribute("height",i.tblHeight.value+i.optHeight.value)),i.txtCellSpacing.value!=""&&(r+=OgEditor.addAttribute("cellSpacing",i.txtCellSpacing.value)),i.txtCellPadding.value!=""&&(r+=OgEditor.addAttribute("cellPadding",i.txtCellPadding.value)),i.tblBorder.value!=""&&(r+=OgEditor.addAttribute("border",i.tblBorder.value)),u="",i.hideBorderColor.value!=undefined&&(u+="border-color:"+i.hideBorderColor.value+";"),i.hideBgColor.value!=undefined&&(u+="background-color:"+i.hideBgColor.value+";"),u!=""&&(u=' style="'+u+'"',r+=u),r+=">\n",r+="<tbody>\n",o=parseInt(i.txtRows.value),s=parseInt(i.txtCells.value),f=0;f<o;f++){for(r+="<tr>\n",e=0;e<s;e++)r+="<td>&nbsp;</td>\n";r+="</tr>\n"}r+="</tbody>\n</table>\n",r+="</table>\n",n("edit_iframe"+t.toString()).contentWindow.insertElemt("table",r,g),OgEditor.closeDialog()},ne=function(i){var r="<"+i+" readonly ";n("selType")&&n("selType").value!=""&&(r+=OgEditor.addAttribute("type",n("selType").value)),n("txtType")&&n("txtType").value!=""&&(r+=OgEditor.addAttribute("type",n("txtType").value)),n("txtValue")&&n("txtValue").value!=""&&(r+=OgEditor.addAttribute("value",n("txtValue").value)),n("txtSize")&&n("txtSize").value!=""&&(r+=OgEditor.addAttribute("size",n("txtSize").value)),n("txtMaxlength")&&n("txtMaxlength").value!=""&&(r+=OgEditor.addAttribute("maxlength",n("txtMaxlength").value)),n("txtID")&&n("txtID").value!=""&&(r+=OgEditor.addAttribute("id",n("txtID").value)),n("txtName")&&n("txtName").value!=""&&(r+=OgEditor.addAttribute("name",n("txtName").value)),n("txtClass")&&n("txtClass").value!=""&&(r+=OgEditor.addAttribute("class",n("txtClass").value)),n("txtStyle")&&n("txtStyle").value!=""&&(r+=OgEditor.addAttribute("style",n("txtStyle").value)),n("txtTabIndex")&&n("txtTabIndex").value!=""&&(r+=OgEditor.addAttribute("tabindex",n("txtTabIndex").value)),n("txtAccessKey")&&n("txtAccessKey").value!=""&&(r+=OgEditor.addAttribute("accesskey",n("txtAccessKey").value)),n("selChecked")&&n("selChecked").value!=""&&(r+=OgEditor.addAttribute("checked",n("selChecked").value)),r+=">",n("txtText")&&n("txtText").value!=""&&(r+=n("txtText").value),i=="textarea"&&(r+="</textarea>"),n("edit_iframe"+t.toString()).contentWindow.insertElemt("Control",r),OgEditor.closeDialog()},ee=function(){n("filOpenForIE").contentWindow.openFile(n("fEnc").value)},ae=function(){var r=n("edit_iframe"+t.toString()).contentWindow.getSelectedHtml(),u=n("selTag").value,i,f;r&&r!=""&&u!=""&&(i="<"+u+' id="'+g+'" ',n("txtID")&&n("txtID").value!=""&&(i+=OgEditor.addAttribute("id",n("txtID").value)),n("txtName")&&n("txtName").value!=""&&(i+=OgEditor.addAttribute("name",n("txtName").value)),n("txtClass")&&n("txtClass").value!=""&&(i+=OgEditor.addAttribute("class",n("txtClass").value)),n("txtStyle")&&n("txtStyle").value!=""&&(i+=OgEditor.addAttribute("style",n("txtStyle").value)),i+=">",u=="pre"&&(f=document.createElement("div"),f.innerHTML=r,r=n("edit_iframe"+t.toString()).contentWindow.removeReadOnly(f),r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),i+=ot(r)+"</"+u+">",n("edit_iframe"+t.toString()).contentWindow.insertElemt("SurroundWith",i,g)),OgEditor.closeDialog()},le=function(){var e=document.formDialgLink,r,i,f,u;n("txtText").value!=""&&(n("edit_iframe"+t.toString()).contentWindow.doesLinkExist()?(r=[],i=0,n("txtUrl").value!=""&&(r[i]=[],r[i].name="href",r[i].value=n("txtUrl").value,i++),n("txtTitle").value!=""&&(r[i]=[],r[i].name="title",r[i].value=n("txtTitle").value,i++),n("txtID").value!=""&&(r[i]=[],r[i].name="id",r[i].value=n("txtID").value,i++),n("txtName").value!=""&&(r[i]=[],r[i].name="name",r[i].value=n("txtName").value,i++),n("txtClass").value!=""&&(r[i]=[],r[i].name="class",r[i].value=n("txtClass").value,i++),n("txtTarget").value!=""&&(r[i]=[],r[i].name="target",r[i].value=n("txtTarget").value,i++),n("txtTabIndex").value!=""&&(r[i]=[],r[i].name="tabindex",r[i].value=n("txtTabIndex").value,i++),n("txtAccessKey").value!=""&&(r[i]=[],r[i].name="accesskey",r[i].value=n("txtAccessKey").value,i++),n("txtStyle").value!=""&&(r[i]=[],r[i].name="style",r[i].value=n("txtStyle").value,i++),n("edit_iframe"+t.toString()).contentWindow.insertHyperLink(r,n("txtText").value)):(f=n("txtText").value,u='<a id="'+g+'" ',n("txtUrl").value!=""&&(u+=OgEditor.addAttribute("href",n("txtUrl").value)),n("txtTitle").value!=""&&(u+=OgEditor.addAttribute("title",n("txtTitle").value)),n("txtID").value!=""&&(u+=OgEditor.addAttribute("id",n("txtID").value)),n("txtName").value!=""&&(u+=OgEditor.addAttribute("name",n("txtName").value)),n("txtClass").value!=""&&(u+=OgEditor.addAttribute("class",n("txtClass").value)),n("txtTarget").value!=""&&(u+=OgEditor.addAttribute("target",n("txtTarget").value)),n("txtTabIndex").value!=""&&(u+=OgEditor.addAttribute("tabindex",n("txtTabIndex").value)),n("txtAccessKey").value!=""&&(u+=OgEditor.addAttribute("accesskey",n("txtAccessKey").value)),n("txtStyle").value!=""&&(u+=OgEditor.addAttribute("style",n("txtStyle").value)),u+=">",u+=OgEditor.trim(f),u+="</a>",n("edit_iframe"+t.toString()).contentWindow.insertElemt("link",u,g)),OgEditor.closeDialog())},ye=function(i){n("edit_iframe"+t.toString()).contentWindow.moveCursor(i)},ve=function(){OgEditor.execCmd("strikethrough",!1,null)},se=function(){var i=n("edit_iframe"+t.toString()).contentWindow.wordCharCount();p=i,OgEditor.openDialog("dialgWordCount",null,"Word/Character Count",null)},oe=function(i){isIE?n("edit_iframe"+t.toString()).contentWindow.execCmd("formatblock",!1,"<"+i+">"):n("edit_iframe"+t.toString()).contentWindow.execCmd("formatblock",!1,i)},ce=function(i){n("edit_iframe"+t.toString()).contentWindow.insertNewElement("","style","font-family",i)},he=function(i){n("edit_iframe"+t.toString()).contentWindow.insertNewElement("","style","font-size",i)},ys=function(){n("edit_iframe"+t.toString()).contentWindow.findRange();var i='<p class="pagebreak" style="page-break-after:always;"></p>';n("edit_iframe"+t.toString()).contentWindow.insertElemt("pagebreak",i)},vs=function(){OgEditor.execCmd("inserthorizontalrule",!1,null)},as=function(n){document.formDialgColor.colorNum.value=n,document.formDialgColor.txtColorDlg.style.backgroundColor=n},ps=function(n){document.formDialgColor.colorNum.value=n,document.formDialgColor.txtColorDlg.style.backgroundColor=n},hs=function(i){OgEditor.focusDoc(),document.formDialgTable&&i==undefined&&document.formDialgTable.txtSelectColor?document.formDialgColor.dialgColorSrc.value=="dialgTable_borderColor"?(document.formDialgTable.txtSelectColor.style.backgroundColor=document.formDialgColor.colorNum.value,document.formDialgTable.hideBorderColor.value=document.formDialgColor.colorNum.value):document.formDialgColor.dialgColorSrc.value=="dialgTable_bgColor"&&(document.formDialgTable.txtBgColor.style.backgroundColor=document.formDialgColor.colorNum.value,document.formDialgTable.hideBgColor.value=document.formDialgColor.colorNum.value):document.formDialgColor.dialgColorSrc.value.toLowerCase()=="backcolor"?document.formDialgColor.colorNum.value!=""&&(n("dialgColorText").value==""?alert("select the text you want to highlight!"):isFirefox?n("edit_iframe"+t.toString()).contentWindow.execCmd("hilitecolor",!1,document.formDialgColor.colorNum.value):n("edit_iframe"+t.toString()).contentWindow.execCmd("backcolor",!1,document.formDialgColor.colorNum.value)):document.formDialgColor.dialgColorSrc.value.toLowerCase()=="fontcolor"&&document.formDialgColor.colorNum.value!=""&&n("edit_iframe"+t.toString()).contentWindow.execCmd("forecolor",!1,document.formDialgColor.colorNum.value),OgEditor.closeDialog()},ss=function(){if(isDemo){alert("Demo version does not allow image uploading.");return}var t=n("newFolderBrowserFolderPath").value;n("filUpload").contentWindow.uploadFile(t)},ls=function(){if(isDemo){alert("Demo version does not allow file uploading.");return}var t=n("newFolderBrowserFolderPath").value;n("filUpload").contentWindow.uploadFile(t)},cs=function(){if(isDemo){alert("Demo version does not allow folder creation."),OgEditor.closeDialog();return}var i=n("newFolderBrowserFolderPath").value,t=n("folderName").value;n("browser").contentWindow.createNewFolder(i,t)},ws=function(t){n("newFolderBrowser")&&n("newFolderBrowser").contentWindow.refreshAndOpenDir_to_openFolders(t)},ih=function(t){n(t).value=n("folderBrowserFolderPath").value,OgEditor.closeDialog()},th=function(t){n(t).value=n("fileBrowserFilePath").value,OgEditor.closeDialog()},nh=function(){n("ogEditorDialog_sub").style.display="none",n("ogEditor_transDiv").style.zIndex=9e4,s="ogEditorDialog"},rh=function(){s=="ogEditorDialog"?(n("ogEditor_transDiv").style.display="none",n("ogEditorDialog").style.display="none",n("ogEditorDialog_content").innerHTML="",s="",n("edit_iframe"+t.toString()).contentWindow.clearRange()):s=="ogEditorDialog_sub"?(n("ogEditorDialog_sub").style.display="none",n("ogEditor_transDiv").style.zIndex=9e4,n("ogEditorDialog_content_sub").innerHTML="",s="ogEditorDialog"):s=="ogEditorDialog_sub_sub"&&(n("ogEditorDialog_sub_sub").style.display="none",n("ogEditor_transDiv").style.zIndex=97500,n("folderBrowser")&&n("folderBrowser").contentWindow.refreshWindow(),n("ogEditorDialog_content_sub_sub").innerHTML="",s="ogEditorDialog_sub")},ks=function(){var t=n("fileType").value,f="",r,u,i;if(t=="xml")f=OgEditor.escapeTags('<?xml version="1.0" encoding="UTF-8"?>\n<DOC>\n</DOC>');else if(t=="css")f=OgEditor.escapeTags("body {\nbackground: #ffffff;\n}");else if(t=="html"&&(r=n("txtTempName").value,r!="blank")){bt(relativePath+"template/"+r+".txt","template");return}for(u=1,i="/default."+t;OgEditor.isExist(i,e);)i="/default"+u.toString()+"."+t,u++;OgEditor.newFile(i,"default",f),OgEditor.closeDialog()},ds=function(){if(n("fileLoc").value!=""&&n("fileLoc").value!="/"){var i="<img ",r=n("fileLoc").value;r=makeRelativePath(a[t],r),i+=OgEditor.addAttribute("src",r),n("txtAlt").value!=""&&(i+=OgEditor.addAttribute("alt",n("txtAlt").value)),n("txtWidth").value!=""&&(i+=OgEditor.addAttribute("width",n("txtWidth").value)),n("txtHeight").value!=""&&(i+=OgEditor.addAttribute("height",n("txtHeight").value)),i+=">",OgEditor.closeDialog(),n("edit_iframe"+t.toString()).contentWindow.insertElemt("image",i)}else alert("please select image file to upload!")},gs=function(n,t){return n+'="'+t+'" '},bs=function(t,i){n("browser").contentWindow.refreshAndOpenDir_to_openFolders(t,i)},wo=function(){var n=document.createElement("DIV"),t;n.className="loadingDiv",n.id="loadingDiv",n.style.zIndex=9e4,n.style.left="0px",n.style.top="0px",n.style.width=(document.documentElement.scrollWidth||document.body.scrollWidth)+"px",n.style.height=(document.documentElement.scrollHeight||document.body.scrollHeight)+"px",n.style.textAlign="center",t=document.createElement("IMG"),t.src=relativePath+"img/loading.gif",t.style.marginTop="130px",n.appendChild(t),document.body.appendChild(n),n.style.display=""},po=function(){n("loadingDiv")&&(n("loadingDiv").style.display="none")},ko=function(){var u=document.createElement("DIV"),r,h,v,a,t,s,l,f,i,o,c,e;u.className="ogEditor_transDiv",u.id="ogEditor_transDiv",u.style.left="0px",u.style.top="0px",u.style.width=(document.documentElement.scrollWidth||document.body.scrollWidth)+"px",u.style.height=(document.documentElement.scrollHeight||document.body.scrollHeight)+"px",n("ogEditor_container").appendChild(u),r=document.createElement("DIV"),r.className="ogEditorDialog",r.id="ogEditorDialog",n("ogEditor_container").appendChild(r),h=document.createElement("DIV"),h.id="ogEditorDialog_header",h.className="ogEditorDialog_header",h.innerHTML='<Label class="ogEditorDialog_lblTitle" id="ogEditorDialog_lblTitle"></Label><a href="javascript:OgEditor.closeDialog();"><img src="'+relativePath+'img/close.gif"  class="ogEditorDialogClose"/></a>',v=document.createElement("DIV"),v.className="ogEditorDialog_content",v.id="ogEditorDialog_content",a=document.createElement("DIV"),a.className="ogEditorDialog_footer",a.innerHTML='<img src="'+relativePath+'img/spacer.gif" height="10px"/>',r.insertBefore(a,r.firstChild),r.insertBefore(v,r.firstChild),r.insertBefore(h,r.firstChild),r.style.width="450px",t=document.createElement("DIV"),t.className="ogEditorDialog",t.id="ogEditorDialog_sub",n("ogEditor_container").appendChild(t),s=document.createElement("DIV"),s.id="ogEditorDialog_header_sub",s.className="ogEditorDialog_header",s.innerHTML='<Label class="ogEditorDialog_lblTitle" id="ogEditorDialog_lblTitle_sub"></Label><a href="javascript:OgEditor.closeDialog();"><img src="'+relativePath+'img/close.gif"  class="ogEditorDialogClose"/></a>',l=document.createElement("DIV"),l.className="ogEditorDialog_content",l.id="ogEditorDialog_content_sub",f=document.createElement("DIV"),f.id="ogEditorDialog_footer_sub",f.className="ogEditorDialog_footer",f.innerHTML='<img src="'+relativePath+'img/spacer.gif" height="10px"/>',t.insertBefore(f,t.firstChild),t.insertBefore(l,t.firstChild),t.insertBefore(s,t.firstChild),t.style.width="450px",t.style.display="none",i=document.createElement("DIV"),i.className="ogEditorDialog",i.id="ogEditorDialog_sub_sub",n("ogEditor_container").appendChild(i),o=document.createElement("DIV"),o.id="ogEditorDialog_header_sub_sub",o.className="ogEditorDialog_header",o.innerHTML='<Label class="ogEditorDialog_lblTitle" id="ogEditorDialog_lblTitle_sub_sub"></Label><a href="javascript:OgEditor.closeDialog();"><img src="'+relativePath+'img/close.gif"  class="ogEditorDialogClose"/></a>',c=document.createElement("DIV"),c.className="ogEditorDialog_content",c.id="ogEditorDialog_content_sub_sub",e=document.createElement("DIV"),e.id="ogEditorDialog_footer_sub_sub",e.className="ogEditorDialog_footer",e.innerHTML='<img src="'+relativePath+'img/spacer.gif" height="10px"/>',i.insertBefore(e,i.firstChild),i.insertBefore(c,i.firstChild),i.insertBefore(o,i.firstChild),i.style.width="450px",i.style.display="none"},ct=function(n){var t=parseInt(n);return t==null||isNaN(t)?0:t},bo=function(i){if(OgEditor.isEventSrcActive())switch(i){case"dialgOpen":isIE?OgEditor.openDialog("dialgOpenForIE",null,"Open",null):OgEditor.openDialog(i,null,"Open",null);break;case"dialgCCtrlList":OgEditor.openDialog(i,null,"Custom control list",null);break;case"dialgNew":OgEditor.openDialog(i,null,"New Document (from templates)",null);break;case"dialgSaveAs":OgEditor.openDialog(i,null,"Save As",null);break;case"dialgTable":OgEditor.openDialog(i,null,"Insert table",null);break;case"dialgImage":OgEditor.openDialog(i,null,"Insert image",null);break;case"dialgColor":OgEditor.openDialog(i,null,"Color",null);break;case"dialgLink":OgEditor.openDialog(i,null,"Insert/Edit hyperlink",null);break;case"dialgFind":OgEditor.openDialog(i,null,"Find/Replace",null);break;case"dialgSurround":OgEditor.openDialog(i,null,"Wrap Html tag around Selection",null);break;case"dialgButton":OgEditor.openDialog(i,null,"Insert button",null);break;case"dialgCheckBox":OgEditor.openDialog(i,null,"Insert checkbox",null);break;case"dialgRadio":OgEditor.openDialog(i,null,"Insert radio button",null);break;case"dialgInputText":OgEditor.openDialog(i,null,"Insert text field",null);break;case"dialgTextArea":OgEditor.openDialog(i,null,"Insert textarea",null);break;case"undo":n("edit_iframe"+t.toString()).contentWindow.execCmd("undo");break;case"redo":n("edit_iframe"+t.toString()).contentWindow.execCmd("redo");break;case"fontcolor":OgEditor.openDialog("dialgColor",i,"Font color",null);break;case"backcolor":OgEditor.openDialog("dialgColor",i,"Background color",null);break;case"strikethrough":OgEditor.strikethrough();break;case"subscript":OgEditor.subscript();break;case"superscript":OgEditor.superscript();break;case"pagebreak":OgEditor.pagebreak();break;case"orderlist":OgEditor.execCmd("insertOrderedList",!1,null);break;case"uorderlist":isIE?OgEditor.execCmd("InsertUnorderedList",!1,null):OgEditor.execCmd("insertUnorderedList",!1,null);break;case"rule":OgEditor.horizontalRule();break;case"justifyleft":OgEditor.justifyleft();break;case"justifycenter":OgEditor.justifycenter();break;case"justifyright":OgEditor.justifyright();break;case"copyToWebClipBoard":OgEditor.copyToWebClipBoard();break;case"pasteFromWebClipBoard":OgEditor.pasteFromWebClipBoard()}},ao=function(i,r,u){OgEditor.isEventSrcActive()&&n("edit_iframe"+t.toString()).contentWindow.execCmd(i,r,u)},lo=function(){var r=!1,t=kt(),i,n;return t&&(i=t.target!=null?t.target:t.srcElement,n=OgEditor.getElemWithTagName("LI",i),n&&(n.className=="liActive"||n.className=="liNaviMenu"))?!0:r},yo=function(n,t){while(t!=null&&t.tagName!=n)t=t.parentNode;return t},kt=function(){var n,t;if(window.event)return window.event;for(n=arguments.callee.caller;n;){if(t=n.arguments[0],t&&t.constructor==MouseEvent)return t;n=n.caller}return null},vo=function(){n("edit_iframe"+t.toString()).contentWindow.showOrHideGuides(""),OgEditor.toSource(),OgEditor.toEdit()},go=function(i){var u=n("guideline_li"),r;u.className!="liInactive"&&(i?r=i=="yes"?!0:!1:n("edit_iframe"+t.toString())&&(r=n("edit_iframe"+t.toString()).contentWindow.isGuideVisible()),u.className=r?"liOn":"liActive")},fs=function(i){n("edit_iframe"+t.toString()).contentWindow.visitNode(i)},us=function(){var r=n("edit_iframe"+t.toString()).contentWindow.getRange(),i;i=isIE?r.text:r.toString(),n("webClipboard").value=OgEditor.escapeTags(i)},os=function(){n("webClipboard").value!=""&&n("edit_iframe"+t.toString()).contentWindow.ptrLocalEvt("execCmd","paste",n("webClipboard").value)},es=function(t,i){var r,u=n("edit_iframe"+f.toString()),o,e;u.focus(),isIE?(r=u.document.selection.createRange(),o=r.text):(r=u.contentWindow.getSelection().getRangeAt(0),o=r.toString()),e=t+o+i,isIE?r.pasteHTML(e):u.contentWindow.document.execCommand("inserthtml",!1,e)},ts=function(t){n("txtDirPath").value=t},ns=function(n){OgEditor.displayFldPath(n);for(var t=0;t<a.length;t++)if(a[t]==n)return;rt++,a[t]=n,OgEditor.addEditScreen(n)},rs=function(){var i,r,t;this.R=66.5,this.L=0,this.deg=0,this.curLeft=0,this.numOfTabs=0,this.tabId=-1,this.curTabId=-1,this.str="",n("slider-list").innerHTML="",n("ogEditor_editor").innerHTML="",i=OgEditor.createImgButton("arrowRight","OgEditor.slidePrev();"),r=OgEditor.createImgButton("arrowLeft","OgEditor.slideNext();"),n("slider-bottons").innerHTML=r,n("slider-bottons").innerHTML+=i,t=dt(),t.id="funcBtns",n("ogEditor_toolbar").insertBefore(t,n("ogEditor_toolbar").firstChild),OgEditor.initializeFuncBtns()},is=function(){var e=n("funcBtns"),r=e.childNodes,t,f,u,i;for(n("btnEdit").disabled=!0,n("btnSource").disabled=!0,n("btnPreview").disabled=!0,n("btnIndentate").disabled=!0,t=0;t<r.length;t++)r[t].id&&(f=r[t].id.split("_"),"open,new".indexOf(f[0])<0&&(r[t].className="liInactive"));for(u=OgEditor.getElementsByClassName("ddlLiOn"),i=0;i<u.length;i++)u[i].className="ddlLiOff";OgEditor.clearAttriCssPane()},dt=function(){for(var r=document.createElement("ul"),e=Vhplustoolbar["default"],u=null,n,t=0;t<e.length;t++){var i=e[t].toLowerCase(),f=VhplustoolbarfuncMap[i].type,s=VhplustoolbarfuncMap[i].method,o=VhplustoolbarfuncMap[i].title;f=="btn"?n=OgEditor.createFuncButton(i,s,o):f=="sep"&&(n=OgEditor.createSeparater()),t==0?r.insertBefore(n,null):r.insertBefore(n,u.nextSibling),u=n}return n=OgEditor.createSeparater(),r.insertBefore(n,u.nextSibling),r},cr=function(n,t){var i=document.createElement("li"),u,r;return i.className="liActive",i.id=n+"_li",u=relativePath+"cctrl/img/icon_"+n+".gif",r="<a href=\"javascript:OgEditor.openDialog('"+n+"',null,'"+t+"','cctrl');\"><img title=\""+n+'" ondragstart="return false;" src="'+u+'" /></a>',i.innerHTML=r,i},vr=function(n,t,i){var r=document.createElement("li"),f,u;return r.className="liActive",r.id=n+"_li",f=relativePath+"img/buttons/icon_"+n+".gif",u='<a href="javascript:void(0);" onclick="'+t+'"><img title="'+i+'" ondragstart="return false;" src="'+f+'" /></a>',r.innerHTML=u,r},ar=function(){var n=document.createElement("li"),i=relativePath+"img/buttons/icon_sep_ie.gif",t;return isIE||(n.className="liSep",i=relativePath+"img/buttons/icon_sep.gif"),t='<img src="'+i+'" />',n.innerHTML=t,n},or=function(){setTimeout("OgEditor.goPrev();",10)},er=function(){var t,i;tt=0,t=hi,k>0&&(t=k),y=n("slider-list").offsetLeft,i=0,-(ht*(nt-1)-66)<y&&OgEditor.slide(i,t)},hr=function(){setTimeout("OgEditor.goNext();",10)},sr=function(){var t,i;tt=0,t=hi,k>0&&(t=k),y=n("slider-list").offsetLeft,i=1,OgEditor.slide(i,t)},yr=function(t,i){var u,f,r;tt+=10,u=i,f=n("slider-list").offsetLeft,tt<180&&(r=u*Math.cos(tt*(Math.PI/180)),r-=u,t==0?n("slider-list").style.left=y+r+"px":f<0&&(n("slider-list").style.left=y-r+"px"),setTimeout("OgEditor.slide("+t+","+i+");",10));return},gr=function(t){var s=t,f,u,r,a,h,o,c;e[i]=t,f=document.createElement("li"),f.id="tab_"+i.toString(),u=document.createElement("a"),u.id="linkHead_"+i.toString(),u.className="linkHead",r=s,a=OgEditor.getDirFromFilePath(s),r=r.replace(/([^\/]*\/)*([^\/]+)$/,"$2"),r.length>20&&(r=r.substring(0,20)),navigator.userAgent.indexOf("MSIE")>-1?u.innerText=r:u.textContent=r,u.href="javascript:OgEditor.switchTab("+i+",'"+s+"');";var l="tabImg_"+i.toString(),w=relativePath+"img/close.gif",p='<img id="'+l+'" name="'+l+'" src="'+w+'" class="order" onclick="OgEditor.closeTab(\''+i.toString()+'\');" style="float:right;"/>';f.insertBefore(u,null),f.innerHTML+=p,n("slider-list").insertBefore(f,null),y=n("slider-list").offsetLeft,h=ht*nt,o=h-ht*2,-o<y&&(k=(y+o)/2,OgEditor.goPrev()),k=0,OgEditor.setActive(i),c=OgEditor.getFileExtension(r),v[i]=htmlExt.indexOf(","+c+",")>=0?"edit":"source",nt++},tu=function(t){var h=e[t],c=OgEditor.getFileExtension(h),s=n("funcBtns"),r=s.childNodes,i,o,f,u;if(v[t]=="edit"&&htmlExt.indexOf(","+c+",")>=0){for(i=0;i<r.length;i++)r[i].className!="liActive"&&r[i].className!="liSep"&&(r[i].className="liActive");for(OgEditor.updateGuideBtn(),f=OgEditor.getElementsByClassName("ddlLiOff"),u=0;u<f.length;u++)f[u].className="ddlLiOn"}else{for(i=0;i<r.length;i++)r[i].id&&(o=r[i].id.split("_"),si.indexOf(","+o[0]+",")<0&&(r[i].className="liInactive"));for(f=OgEditor.getElementsByClassName("ddlLiOn"),u=0;u<f.length;u++)f[u].className="ddlLiOff"}},nu=function(i,r){n("edit_iframe"+t.toString()).contentWindow.delSelBorder();var e=OgEditor.getDirFromFilePath(r),f=r.substring(r.lastIndexOf("/")+1),u=OgEditor.setActiveFlder(e);if(u)n("edit_iframe"+t.toString()).contentWindow.setInit(),OgEditor.setActive(i),OgEditor.waitAndOpenFile("",f),OgEditor.showOrHideFuncBtns(i),n("edit_iframe"+t.toString()).contentWindow.RClickMenus.hideMenus(),OgEditor.clearAttriCssPane(),n("edit_iframe"+t.toString()).contentWindow.addOnclickEventToChilds(),n("edit_iframe"+t.toString()).contentWindow.focusEditScreen(),OgEditor.getInternalStyles();else{alert("An error has occured Please contact your system admin.  error code: A0002");return}},wr=function(t){var u=n("tabImg_"+t.toString()),r=e[t],i=u.parentNode;n("slider-list").removeChild(i),nt--,OgEditor.remTab(t,r),nt<=0&&OgEditor.initializeFuncBtns()},pr=function(n){var t=n.substring(0,n.lastIndexOf("/"));return t==""&&(t="/"),t},kr=function(r,u){var c=OgEditor.getDirFromFilePath(u),s=u.substring(u.lastIndexOf("/")+1),f,h,o;for(e[r]="",no[r]="",v[r]="",f=0;f<=rt;f++)a[f]==c&&n("edit_iframe"+t.toString()).contentWindow.closeFile(s);for(h=!1,f=i;f>=0;f--)if(n("linkHead_"+f.toString())){o=e[f],OgEditor.switchTab(f,o);return}},br=function(n){return/[\.]/.exec(n)?/[^\.]+$/.exec(n):undefined},fr=function(t){for(var c,l,r,h,s,o=i;o>=0;o--)if(n("linkHead_"+o.toString()))if(t==o){n("linkHead_"+o.toString()).className="linkHead",f=o,c=e[o],OgEditor.displayFldPath(c);var v=OgEditor.getFileExtension(c),a=n("funcBtns"),u=a.childNodes;if(htmlExt.indexOf(","+v+",")<0){for(n("btnEdit").disabled=!0,n("btnSource").disabled=!0,n("btnPreview").disabled=!0,n("btnIndentate").disabled=!1,n("btnIndentate").style.cursor="pointer",n("btnEdit").style.cursor="default",n("btnSource").style.cursor="default",n("btnPreview").style.cursor="default",r=0;r<u.length;r++)u[r].id&&(l=u[r].id.split("_"),si.indexOf(","+l[0]+",")<0?u[r].className="liInactive":u[r].className!="liSep"&&(u[r].className="liActive"));for(h=OgEditor.getElementsByClassName("ddlLiOn"),s=0;s<h.length;s++)h[s].className="ddlLiOff"}else{for(n("btnEdit").disabled=!1,n("btnSource").disabled=!1,n("btnPreview").disabled=!1,n("btnIndentate").disabled=!1,n("btnIndentate").style.cursor="pointer",n("btnEdit").style.cursor="pointer",n("btnSource").style.cursor="pointer",n("btnPreview").style.cursor="pointer",r=0;r<u.length;r++)u[r].className!="liActive"&&u[r].className!="liSep"&&(u[r].className="liActive");for(h=OgEditor.getElementsByClassName("ddlLiOff"),s=0;s<h.length;s++)h[s].className="ddlLiOn"}}else n("linkHead_"+o.toString()).className="linkTail";OgEditor.updateGuideBtn()},pi=function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent&&n.detachEvent("on"+t,i)},yi=function(){n("edit_iframe"+t.toString()).contentWindow.ptrLocalEvt("print")},li=function(){n("edit_iframe"+t.toString()).contentWindow.ptrLocalEvt("preview")},wi=function(){var r=e[f],i=OgEditor.getFileExtension(r);if(htmlExt.indexOf(","+i+",")<0){if(",js,css,".indexOf(","+i+",")<0){alert("Reformat function works with html, js, and css files only.");return}n("edit_iframe"+t.toString()).contentWindow.ptrLocalEvt("formatNonHTMLCode")}else n("edit_iframe"+t.toString()).contentWindow.ptrLocalEvt("formatHTML")},vi=function(){f<0||(n("edit_iframe"+t.toString()).contentWindow.formatHTMLwithColors(),v[f]="source",OgEditor.showOrHideFuncBtns(f))},ci=function(){n("edit_iframe"+t.toString()).contentWindow.ptrLocalEvt("toSource"),v[f]="source",OgEditor.showOrHideFuncBtns(f),OgEditor.clearAttriCssPane()},ai=function(){n("edit_iframe"+t.toString()).contentWindow.ptrLocalEvt("sourceToEdit"),v[f]="edit",OgEditor.showOrHideFuncBtns(f),OgEditor.getInternalStyles()},ot=function(n){return n.replace(/~\s+|\s+$/g,"")},ir=function(n,t){var h=n+i.toString(),s=n+i.toString(),e=relativePath+"img/buttons/icon_"+n+".gif",c="javascript:this.className='button_over';",o="javascript:this.className='button_out';",u="javascript:this.className='button_down';",f="javascript:this.className='button_out';",r='<img id="'+h+'" name="'+s+'" src="'+e+'" class="button_out" onmouseover="'+c+'" ';return r+='onmouseout="'+o+'" onmousedown="'+u+'" onmouseup="'+f+'" onclick="'+t+'" />'},tr=function(){this.className="button_over"},ui=function(){var t=n("browser").contentWindow.document.body;t?n("browser").contentWindow.getHomePath():setTimeout(ui,100)},rr=function(t){var r=document.createElement("iframe"),i,u;r.id="edit_iframe"+rt.toString(),r.className="ogEditFrame",r.style.width="100%",r.style.height="100%",r.style.display="none",r.frameBorder="0",i=makeRelativePath(pathToYourEditorFolder,profileRoot),i&&(i!=""||i!="/")&&(i=i+"/"),u="",u=t=="/"?i+o+"/_ed.htm":i+o+t+"/_ed.htm",r.src=u,n("ogEditor_editor").insertBefore(r,n("ogEditor_editor").firstChild)},nr=function(i){for(var u=!1,r=0;r<=rt;r++)a[r]==i?(n("edit_iframe"+r.toString()).style.display="",t=r):n("edit_iframe"+r.toString()).style.display="none";return r>=rt&&(u=!0),u},ki=function(t){var i=n("common").contentWindow.loadFile_to_openFile(t)},bi=function(i,r){var u=n("edit_iframe"+t.toString()).contentWindow.document.body;u?n("edit_iframe"+t.toString()).contentWindow.openFile(i,r):setTimeout(OgEditor.waitAndOpenFile,100)},gi=function(t){var u,s,o,r,h;if(t!=undefined){for(s=OgEditor.getDirFromFilePath(t),o=t.substring(t.lastIndexOf("/")+1),r=0;r<e.length;r++)if(e[r]==t){u=OgEditor.setActiveFlder(s),u?(OgEditor.setActive(r),OgEditor.waitAndOpenFile("",o),OgEditor.getInternalStyles()):alert("An error has occured Please contact your system admin.  error code: A0003");return}i++,f=i,h=n("common").contentWindow.getFileContents(),u=OgEditor.setActiveFlder(s),u?(OgEditor.addTab(t),OgEditor.waitAndOpenFile(h,o),et>0&&OgEditor.closeTab(et),et=-1,OgEditor.getInternalStyles()):alert("An error has occured Please contact your system admin.  error code: A0004")}},di=function(){var u=n("edit_iframe"+t.toString()).contentWindow.getInternalStyles(),f,i,r,e;if(u)for(f=n("fieldInternalStyles"),f.innerHTML='<legend title="Internal styles are defined in the &lt;head&gt; section of an HTML page, by using the &lt;style&gt; tag.">Internal Style Sheet</legend>',i=0;i<u.length;i++)r=u[i].body,r=r.replace(/([\n])([ \t]+)([^\n])/g,"$1$3"),e='<label for="internalStyle">&lt;style type=&quot;text/css&quot;&gt;</label><br><textarea id="internalStyle_'+i.toString()+'" class="tareaInternalStyle" name="internalStyle" rows="20" cols="40" title="internal style">'+r+'</textarea><br><label for="internalStyle">&lt;/style&gt;</label><br>',f.innerHTML+=e;else n("fieldInternalStyles").innerHTML=""},iu=function(n){var i,t;if(n)for(i='<legend title="inline styles are defined in the style attribute in the relevant tag.">Inline Styles</legend>',t=0;t<n.length;t++)i+='<label for="inlineStyles">style=</label><br><textarea name="inlineStyles" rows="14" cols="35" id="inlineStyles" tabindex="4" title="Inline Styles"></textarea><br><br>'},of=function(){n("txtNodePath").innerHTML="",n("cssEditor_attributes").innerHTML="",n("fieldInternalStyles").innerHTML="",n("btnUpdateElemAtts").disabled=!0},ef=function(i){i=i!=""?'<fieldset id="fieldElemAttributes" class="cssEditorfield">'+i+"</fieldset>":'<div class="ogEditorDialog_desc">HTML attributes are not found.</div>',n("cssEditor_attributes").innerHTML=i,n("btnUpdateElemAtts").disabled=!1,n("edit_iframe"+t.toString()).contentWindow.focusEditScreen()},hf=function(t){var f,u,r,i,o,e;if(t!="")for(n("txtNodePath").innerHTML="",f=t.split("="),u=0,r=f.length;r>0;r--)f[r]!=undefined&&(i=document.createElement("a"),i.id="linkBtn"+u.toString(),i.name="linkBtn"+u.toString(),i.href="javascript:OgEditor.visitElem("+u.toString()+");",i.innerHTML=f[r],n("txtNodePath").insertBefore(i,n("txtNodePath").firstChild),o=document.createTextNode(" > "),n("txtNodePath").insertBefore(o,n("txtNodePath").firstChild),u++);else e=document.createTextNode("body"),n("txtNodePath").insertBefore(e,n("txtNodePath").firstChild)},sf=function(){var s=n("dialgCctrlType").value,h=n("iCtrl").contentWindow.document,o="",r,f,u,i,e;for(h.getElementById("ogCCStyle_"+s)&&(o=h.getElementById("ogCCStyle_"+s).innerHTML),o&&o!=""&&(o="/*--------------------------------------------------------------------------\n\t  ogEditor CControl: "+s+" Please do not modify this line.\n----------------------------------------------------------------------------*/\n"+o),r=h.getElementById("ogCCHtml_"+s).innerHTML,f=ogCControl[s],u=0;u<f.ogCCGeneral.length;u++)i=f.ogCCGeneral[u].attribute,e=f.ogCCGeneral[u].key,r=n("txt"+i).value&&ot(n("txt"+i).value)!=""?r.indexOf(i+'="{'+i+'}"')!=-1?r.replace(i+'="{'+i+'}"',e+'="'+n("txt"+i).value+'"'):r.indexOf(i.toLowerCase()+'="{'+i+'}"')!=-1?r.replace(i.toLowerCase()+'="{'+i+'}"',e+'="'+n("txt"+i).value+'"'):r.indexOf("{"+i+"}")!=-1?r.replace("{"+i+"}",n("txt"+i).value):r.replace(i+'="{'+i+'}"',""):r.replace(i+'="{'+i+'}"',"");for(u=0;u<f.ogCCDetails.length;u++)i=f.ogCCDetails[u].attribute,e=f.ogCCDetails[u].key,r=n("txt"+i).value&&ot(n("txt"+i).value)!=""?r.indexOf(i+'="{'+i+'}"')!=-1?r.replace(i+'="{'+i+'}"',e+'="'+n("txt"+i).value+'"'):r.indexOf(i.toLowerCase()+'="{'+i+'}"')!=-1?r.replace(i.toLowerCase()+'="{'+i+'}"',e+'="'+n("txt"+i).value+'"'):r.indexOf("{"+i+"}")!=-1?r.replace("{"+i+"}",n("txt"+i).value):r.replace(i+'="{'+i+'}"',""):r.replace(i+'="{'+i+'}"',"");n("edit_iframe"+t.toString()).contentWindow.insertCCtrl(r,o,s),OgEditor.toSource(),OgEditor.toEdit(),OgEditor.closeDialog()},ff=function(){for(var f=OgEditor.getElementsByClassName("cssEditorDialogAttributes"),r=[],u,i=0;i<f.length;i++)r[i]=[],r[i].name=f[i].name,r[i].value=f[i].value.replace(/\"/g,"'");u="",n("cssEditorDialogStyle")&&(u=n("cssEditorDialogStyle").value),n("edit_iframe"+t.toString()).contentWindow.updateElemAttributes(r,u),OgEditor.updateInternalStyle()},tf=function(){for(var r=OgEditor.getElementsByClassName("tareaInternalStyle"),u=[],i=0;i<r.length;i++)u[i]=r[i].value.replace(/\"/g,"'");n("edit_iframe"+t.toString()).contentWindow.updateInternalStyles(u),OgEditor.toSource(),OgEditor.toEdit()},nf=function(){for(var i=n("attriName").value,f=n("attriValue").value,u=OgEditor.getElementsByClassName("cssEditorDialogAttributes"),r,t=0;t<u.length;t++)if(i.toLowerCase()==u[t].name.toLowerCase()||i.toLowerCase()=="style"){alert("attribute name already exists!");return}r='<label class="attribute">'+i+'</label><input class="cssEditorDialogAttributes" name="'+i+'" value="'+f.replace(/^[\'\"]|[\'\"]$/g,"")+'" type="text" /><br>',n("divAttri").innerHTML+=r,OgEditor.closeDialog()},uf=function(n,t,r){for(var s=OgEditor.getDirFromFilePath(n),o,h=n.substring(n.lastIndexOf("/")+1),u=0;u<e.length;u++)if(e[u]==n){o=OgEditor.setActiveFlder(s),o?(OgEditor.setActive(u),OgEditor.waitAndOpenFile("",h),OgEditor.getInternalStyles()):alert("An error has occured Please contact your system admin.  error code: A0005");return}i++,f=i,o=OgEditor.setActiveFlder(s),o?(OgEditor.addTab(n),OgEditor.waitAndOpenFile(wt(r),h),OgEditor.getInternalStyles()):alert("An error has occured Please contact your system admin.  error code: A0006")},wt=function(n){return n.replace(/&#39;/g,"'").replace(/&quot;/gi,'"').replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&")},wf=function(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;").replace(/\u00a9/g,"&copy;").replace(/\u00ae/g,"&reg;").replace(/\u2122/g,"&trade;").replace(/\u00a2/g,"&cent;").replace(/\u00a3/g,"&pound;").replace(/\u00a4/g,"&curren;").replace(/\u00a5/g,"&yen;").replace(/\u20ac/g,"&euro;")},pf=function(){cw=n("ogEditor_container").offsetWidth,l=n("ogEditor_editScene").offsetWidth,n("slider-stage").style.width=l-75+"px",b=n("ogEditor_vLine").offsetWidth,r=cw-l-b,r<0&&(r=0),n("ogEditor_fManager").style.width=n("ogEditor_cssEditor").style.width=n("ogEditor_hLine").style.width=r-b+w+"px",ch=n("ogEditor_container").offsetHeight,ch-=c,u=parseInt(ch*ei,10),d=ch-u-n("ogEditor_hLine").offsetHeight,n("ogEditor_editScene").style.height=ch+"px",n("ogEditor_editor").style.height=ch-45+"px",n("ogEditor_fManager").style.height=u+"px",n("ogEditor_cssEditor").style.height=d+"px",n("ogEditor_vLine").style.height=ch+"px",n("ogEditor_hLine").style.top=u+"px",n("ogEditor_cssEditor").style.top=u+n("ogEditor_hLine").offsetHeight+"px"},kf=function(){var i=document.createElement("div"),y,rt,t,c,l,a,d,ct,r,h,u,k,g,nt,b,p,ht,s,tt,vt,e,ut,lt,f,it,at,v,w,ot,et,ft,st;i.id="ogEditor_container",y=document.createElement("div"),y.id="ogEditor_navigationLink",y.className="navigation",rt=document.createElement("div"),rt.className="ogEditor_menu",t="<ul>",t+=isIE?'<li><a class="left_sub" onmouseover="OgEditor.ogNaviMenuLiHover(this);" href="javascript:void(0);">File</a>':'<li><a class="left_sub" href="javascript:void(0);">File</a>',t+='<ul><li class="liNaviMenu"><a href="javascript:void(0);" onclick="OgEditor.funcBtnPressed(\'dialgNew\');">New</a></li><li class="liNaviMenu"><a href="javascript:void(0);" onclick="OgEditor.funcBtnPressed(\'dialgOpen\');">Open</a></li><li class="liNaviMenu"><a href="javascript:void(0);" onclick="OgEditor.funcBtnPressed(\'dialgSaveAs\');">Save</a></li></ul></li>',t+=isIE?'<li><a class="center_sub" onmouseover="OgEditor.ogNaviMenuLiHover(this);" href="javascript:void(0);">Edit</a>':'<li><a class="center_sub" href="javascript:void(0);">Edit</a>',t+='<ul><li class="liNaviMenu"><a href="javascript:void(0);" onclick="OgEditor.execCmd(\'cut\', null, null);">Cut</a></li><li class="liNaviMenu"><a href="javascript:void(0);" onclick="OgEditor.funcBtnPressed(\'copyToWebClipBoard\');">Copy</a></li><li class="liNaviMenu"><a href="javascript:void(0);" onclick="OgEditor.funcBtnPressed(\'pasteFromWebClipBoard\');">Paste</a></li></ul></li>',t+=isIE?'<li><a class="center_sub" onmouseover="OgEditor.ogNaviMenuLiHover(this);" href="javascript:void(0);">Insert</a>':'<li><a class="center_sub" href="javascript:void(0);">Insert</a>',t+='<ul><li class="liNaviMenu"><a href="javascript:void(0);" onclick="OgEditor.funcBtnPressed(\'dialgButton\');">Insert button</a></li><li class="liNaviMenu"><a href="javascript:void(0);" onclick="OgEditor.funcBtnPressed(\'dialgCheckBox\');">Insert checkbox</a></li><li class="liNaviMenu"><a href="javascript:void(0);" onclick="OgEditor.funcBtnPressed(\'dialgRadio\');">Insert radio button</a></li><li class="liNaviMenu"><a href="javascript:void(0);" onclick="OgEditor.funcBtnPressed(\'dialgInputText\');">Insert text field</a></li><li class="liNaviMenu"><a href="javascript:void(0);" onclick="OgEditor.funcBtnPressed(\'dialgTextArea\');">Insert textarea</a></li></ul></li>',t+=isIE?'<li><a class="center_sub" onmouseover="OgEditor.ogNaviMenuLiHover(this);" href="javascript:void(0);">Tool</a>':'<li><a class="center_sub" href="javascript:void(0);">Tool</a>',t+='<ul><li class="liNaviMenu"><a onclick="OgEditor.wordCharCount();" href="javascript:void(0);">Word/Character Count</a></li><li class="liNaviMenu"><a onclick="OgEditor.formatHTMLwithColors();" href="javascript:void(0);">Tag Highlighter</a></li></ul></li>',t+=isIE?'<li><a class="right_sub" onmouseover="OgEditor.ogNaviMenuLiHover(this);" href="javascript:void(0);">Help</a>':'<li><a class="right_sub" href="javascript:void(0);">Help</a>',t+='<ul><li class="liNaviMenu"><a href="javascript:void(0);" onclick="OgEditor.openDialog(\'dialgAbout\',null,\'Version\',null);">Version</a></li><li class="liNaviMenu"><a href="http://www.ogEditor.com/contact.html" target="_blank">Contact Us</a></li></ul></li></ul>',rt.innerHTML=t,y.insertBefore(rt,y.firstChild),c=document.createElement("iframe"),c.id="common",c.name="iDialog",c.style.display="none",c.frameborder="0",c.scrolling="no",c.src=relativePath+"common.aspx?user="+o,l=document.createElement("iframe"),l.id="iDialog",l.name="iDialog",l.style.display="none",l.frameborder="0",l.scrolling="no",l.src=relativePath+"dialog/dialog.html",a=document.createElement("iframe"),a.id="iCtrl",a.name="iCtrl",a.style.display="none",a.frameborder="0",a.scrolling="no",a.src=relativePath+"cctrl/cctrl.html",d=document.createElement("input"),d.id="webClipboard",d.name="webClipboard",d.type="hidden",ct=document.createElement("div"),ct.id="ogEditor_toolbar",r=document.createElement("div"),r.id="ogEditor_fmain",h=document.createElement("div"),h.id="ogEditor_cssEditor",h.className="ogEditor_cssEditor",h.style.width="100%",h.style.height="90%",u=document.createElement("div"),u.id="ogCssEditorPane",u.style.width="100%",u.style.height="100%",u.style.overflow="auto",k=document.createElement("div"),k.id="ogCssHeader",g=document.createElement("div"),g.className="ogCssDesc",nt=document.createElement("div"),nt.id="txtNodePath",nt.name="txtNodePath",nt.className="cssClassDisp",g.insertBefore(nt,g.firstChild),k.insertBefore(g,k.firstChild),b=document.createElement("div"),b.id="ogCssEditor",b.style.overflow="hidden",p='<div id="ogEditor_tabNavbar" style="width:100%;height:100%;position:relative;"><div id="ogEditor_tabHolder"><ul id="ogEditor_navTabs"><li id="onlink"><a href="javascript:OgEditor.showTabContainer(\'ogEditor_navTabs\',\'cssEditor_attributes\');">Attributes</a></li><li><a href="javascript:OgEditor.showTabContainer(\'ogEditor_navTabs\',\'cssEditor_styles\');">Internal Styles</a></li></ul> <div>',p+=isIE?'<a href="javascript:void(0);" onclick="OgEditor.moveCursor(true);" style="border:0;position:absolute;top:0;left:175px;"><img src="'+relativePath+'img/buttons/icon_cursorLeft.gif" title="put cursor on the front of next child node" style="border:0;margin:0 5px 0 0;"/></a><a href="javascript:void(0);" onclick="OgEditor.moveCursor(false);" style="border:0;position:absolute;top:0;left:200px;"><img src="'+relativePath+'img/buttons/icon_cursorRight.gif" title="put cursor on the end of next child node" style="border:0;margin:0 5px 0 0;"/></a>':'<a href="javascript:void(0);" onclick="OgEditor.moveCursor(false);" style="border:0;position:absolute;top:0;left:200px;"><img src="'+relativePath+'img/buttons/icon_cursorLeft.gif" title="put cursor on the front/end of next child node" style="border:0;margin:0 5px 0 0;"/></a>',p+='<a id="btnUpdateElemAtts" href="javascript:void(0);" onclick="OgEditor.updateElemAttributes();" style="border:0;position:absolute;top:0;left:225px;"><img src="'+relativePath+'img/buttons/icon_refresh.gif" title="Update both attributes and internal styles" style="border:0;margin:0 5px 0 0;"/></a></div></div> <!-- end ogEditor_tabHolder div --> <div id="cssEditor_top" class="ogEditor_tabContainerTop" style="width:100%;height:90%;overflow:auto;"><div id="cssEditor_attributes" class="ogEditor_tabContainer"></div><div id="cssEditor_styles" class="ogEditor_tabContainer" style="display:none;"><fieldset id="fieldInternalStyles" class="cssEditorfield"></fieldset></div><!-- end ogEditor_tabContainer div --></div> <!-- end ogEditor_tabContainerTop div --></div> <!-- end ogEditor_tabNavbar div -->',b.innerHTML=p,u.insertBefore(b,u.firstChild),u.insertBefore(k,u.firstChild),h.insertBefore(u,h.firstChild),ht=document.createElement("div"),ht.id="ogEditor_hLine",s=document.createElement("div"),s.id="ogEditor_fManager",tt=document.createElement("div"),tt.id="location",vt='<div id="tree-path" class="ogEditor_fmanager_title"><input type="text" name="" id="txtDirPath" readonly class="dirPathBox" value="/" /><a href="javascript:OgEditor.openDialog(\'dialgPlus\',null,\'Upload file/Add folder\', null);" style="border:0;"><img src="'+relativePath+'img/buttons/icon_addfile.gif" title="Upload file/Add folder" style="border:0;"/></a><a href="javascript:OgEditor.refreshFileManager();" style="border:0;"><img src="'+relativePath+'img/buttons/icon_refresh.gif" title="Refresh" style="border:0;"/></a></div>',tt.innerHTML=vt,e=document.createElement("iframe"),e.id="browser",e.name="browser",e.width="100%",e.height="95%",e.frameborder="0",e.scrolling="yes",e.src=relativePath+"browser.aspx?user="+o+"&edIgnore=false",ut=document.createElement("textarea"),ut.id="newFileContents",ut.style.display="none",s.insertBefore(ut,s.firstChild),s.insertBefore(e,s.firstChild),s.insertBefore(tt,s.firstChild),lt=document.createElement("div"),lt.id="ogEditor_vLine",f=document.createElement("div"),f.id="ogEditor_editScene",it=document.createElement("div"),it.id="ogEditor_modebar",at='<ul id="ogEditor_modeBtns" class="ogEditor_modeBtns"><li id="liHeading" class="ddlLiOn"><div id="titleHeading" class="ddlmenu clearfx" style="width:77px"><label class="lblForOgDDList" onmouseover="OgEditor.lblDDlistMOver();" onmouseout="OgEditor.lblDDlistMOut();" onclick="OgEditor.showDDList(\'Heading\');">Heading</label><p><img class="ddlImg" onmouseover="OgEditor.lblDDlistMOver();" onmouseout="OgEditor.lblDDlistMOut();" onclick="OgEditor.showDDList(\'Heading\');" src="'+relativePath+'img/buttons/downArrow.gif"></p></div></li><li id="liFontFamily" class="ddlLiOn"><div id="titleFontFamily" class="ddlmenu clearfx" style="width:85px"><label class="lblForOgDDList" onmouseover="OgEditor.lblDDlistMOver();" onmouseout="OgEditor.lblDDlistMOut();" onclick="OgEditor.showDDList(\'FontFamily\');">Font family</label><p><img class="ddlImg" onmouseover="OgEditor.lblDDlistMOver();" onmouseout="OgEditor.lblDDlistMOut();" onclick="OgEditor.showDDList(\'FontFamily\');" src="'+relativePath+'img/buttons/downArrow.gif"></p></div></li><li id="liFontSize" class="ddlLiOn"><div id="titleFontSize" class="ddlmenu clearfx" style="width:77px"><label class="lblForOgDDList" onmouseover="OgEditor.lblDDlistMOver();" onmouseout="OgEditor.lblDDlistMOut();" onclick="OgEditor.showDDList(\'FontSize\');">Font size</label><p><img class="ddlImg" onmouseover="OgEditor.lblDDlistMOver();" onmouseout="OgEditor.lblDDlistMOut();" onclick="OgEditor.showDDList(\'FontSize\');" src="'+relativePath+'img/buttons/downArrow.gif"></p></div></li><li id="liEdit" class="btn"><input id="btnEdit" onclick="OgEditor.toEdit()" type=button value="design" title="Design view"/></li><li id="liSource" class="btn"><input id="btnSource" onclick="OgEditor.toSource()" type=button value="source" title="Source view"/></li><li id="liPreview" class="btn"><input id="btnPreview" onclick="OgEditor.previewContents()" type=button value="preview" title="preview html"/></li><li id="liIndentate" class="btn"><input id="btnIndentate" onclick="OgEditor.textindentate()" type=button value="reformat" title="reformat html/js/css code" style="width:60px;"/></li></ul>',it.innerHTML=at,v=document.createElement("div"),v.id="ogEditor_slider",w=document.createElement("div"),w.id="slider-stage",ot=document.createElement("ul"),ot.id="slider-list",w.insertBefore(ot,w.firstChild),et=document.createElement("div"),et.id="slider-bottons",v.insertBefore(et,v.firstChild),v.insertBefore(w,v.firstChild),ft=document.createElement("div"),ft.id="ogEditor_editor",f.insertBefore(ft,f.firstChild),f.insertBefore(v,f.firstChild),f.insertBefore(it,f.firstChild),r.insertBefore(h,r.firstChild),r.insertBefore(ht,r.firstChild),r.insertBefore(s,r.firstChild),r.insertBefore(lt,r.firstChild),r.insertBefore(f,r.firstChild),i.insertBefore(d,i.firstChild),i.insertBefore(l,i.firstChild),i.insertBefore(a,i.firstChild),i.insertBefore(c,i.firstChild),i.insertBefore(r,i.firstChild),i.insertBefore(ct,i.firstChild),i.insertBefore(y,i.firstChild),parentNodeID==""?document.body.insertBefore(i,document.body.firstChild):(st=n(parentNodeID),st.insertBefore(i,st.firstChild))},bf=function(){var t,i,e,f;OgEditor.showLoading(),OgEditor.writeEditorScreen(),OgEditor.init(),OgEditor.createOgDDList(),t=n("ogEditor_container"),OgEditor.addEvent(t,"dragenter",OgEditor.cancelDefault),OgEditor.addEvent(t,"dragover",OgEditor.cancelDefault),OgEditor.addEvent(t,"drop",OgEditor.cancelDefault),OgEditor.addEvent(t,"click",OgEditor.hideDDlist),i=n("browser").contentWindow.document,OgEditor.addEvent(i,"dragenter",it),OgEditor.addEvent(i,"dragover",it),OgEditor.addEvent(i,"drop",it),OgEditor.addEvent(i,"keydown",OgEditor.keyDowned),OgEditor.addEvent(document.body,"keydown",OgEditor.keyDowned),isFullScreen?(t.style.width="100%",t.style.height="100%"):(ogEditorWidth.indexOf("px")==-1&&(ogEditorWidth+="px"),t.style.width=ogEditorWidth,ogEditorHeight.indexOf("px")==-1&&(ogEditorHeight+="px"),t.style.height=ogEditorHeight,t.style.position="relative"),e=n("ogEditor_navigationLink"),window.File&&window.FileList&&window.FileReader&&(f=new XMLHttpRequest,f.upload&&(OgEditor.addEvent(t,"dragenter",OgEditor.cancelDefault),OgEditor.addEvent(t,"dragover",OgEditor.cancelDefault),OgEditor.addEvent(t,"dragleave",OgEditor.cancelDefault),OgEditor.addEvent(t,"drop",OgEditor.fileDripped))),cw=n("ogEditor_container").offsetWidth,l=parseInt(cw*ge,10),b=n("ogEditor_vLine").offsetWidth,r=cw-l-b,r<0&&(r=0),n("ogEditor_editScene").style.width=n("ogEditor_editor").style.width=l+"px",n("slider-stage").style.width=l-75+"px",n("ogEditor_fManager").style.width=n("ogEditor_cssEditor").style.width=n("ogEditor_hLine").style.width=r-b+w+"px",n("ogEditor_vLine").style.left=l+"px",n("ogEditor_fManager").style.left=n("ogEditor_cssEditor").style.left=n("ogEditor_hLine").style.left=l+n("ogEditor_vLine").offsetWidth+"px",ch=cw=n("ogEditor_container").offsetHeight,ch-=c,u=parseInt(ch*.4,10),d=ch-u-n("ogEditor_hLine").offsetHeight,n("ogEditor_editScene").style.height=ch+"px",n("ogEditor_editor").style.height=ch-45+"px",n("ogEditor_fManager").style.height=u+"px",n("ogEditor_cssEditor").style.height=d+"px",n("ogEditor_vLine").style.height=ch+"px",n("ogEditor_hLine").style.top=u+"px",n("ogEditor_cssEditor").style.top=u+n("ogEditor_hLine").offsetHeight+"px",drag=0,n("ogEditor_vLine").onmousedown=function(){drag="ogEditor_vLine",n("ogEditor_vLine").style.backgroundColor="#aaaaaa",n("ogEditor_editor").style.display="none",n("browser").style.display="none"},n("ogEditor_hLine").onmousedown=function(){drag="ogEditor_hLine",n("ogEditor_hLine").style.backgroundColor="#aaaaaa",n("ogEditor_editor").style.display="none",n("browser").style.display="none"},document.onmouseup=function(){h!=null&&(document.onselectstart=null,h.ondragstart=null,h=null),drag&&(drag=0,n("ogEditor_vLine").style.backgroundColor=n("ogEditor_hLine").style.backgroundColor="#eeeeee",n("ogEditor_editor").style.display="",n("browser").style.display="")},document.onmousemove=function(t){var f,i;t=window.event||t,h!=null&&(f=OgEditor.getCurPosition(t),i=OgEditor.getOffset(n("ogEditor_container")),h.style.left=ti+f.left-i.left-fi+"px",h.style.top=ii+f.top-i.top-ri+"px"),drag&&(f=OgEditor.getCurPosition(t),i=OgEditor.getOffset(n("ogEditor_container")),drag=="ogEditor_vLine"&&(cw=n("ogEditor_container").offsetWidth,l=f.left-i.left,r=cw-l-b,n("ogEditor_editScene").style.width=n("ogEditor_editor").style.width=l+"px",n("slider-stage").style.width=l-75+"px",n("ogEditor_vLine").style.left=l+"px",n("ogEditor_fManager").style.left=n("ogEditor_cssEditor").style.left=n("ogEditor_hLine").style.left=l+b+"px",n("ogEditor_fManager").style.width=n("ogEditor_cssEditor").style.width=n("ogEditor_hLine").style.width=r-b+w+"px"),drag=="ogEditor_hLine"&&(ch=n("ogEditor_container").offsetHeight,ch-=c,u=f.top-i.top,u-=c,ei=u/ch,d=ch-u-n("ogEditor_hLine").offsetHeight,n("ogEditor_fManager").style.height=u+"px",n("ogEditor_cssEditor").style.height=d+"px",n("ogEditor_hLine").style.top=u+"px",n("ogEditor_cssEditor").style.top=u+n("ogEditor_hLine").offsetHeight+"px"))},document.onmousedown=function(t){var u,r,i;return t=window.event||t,u=t.target!=null?t.target:t.srcElement,(t.button==1&&window.event!=null||t.button==0)&&u.className=="ogEditorDialog_lblTitle"?(r=OgEditor.getCurPosition(t),i=OgEditor.getOffset(n("ogEditor_container")),n("ogEditorDialog_sub_sub").style.display!="none"?h=n("ogEditorDialog_sub_sub"):n("ogEditorDialog_sub").style.display!="none"?h=n("ogEditorDialog_sub"):n("ogEditorDialog").style.display!="none"&&(h=n("ogEditorDialog")),fi=r.left-i.left,ri=r.top-i.top,ti=ct(h.style.left),ii=ct(h.style.top),we=h.style.zIndex,document.body.focus(),document.onselectstart=function(){return!1},u.ondragstart=function(){return!1},!1):void 0}},yf=function(n){n=window.event||n;var t=n.target!=null?n.target:n.srcElement,i=n.keyCode||n.charCode;return t&&(t.tagName.toUpperCase()=="INPUT"||t.tagName.toUpperCase()=="TEXTAREA")?!0:i==8||i==46?(n.preventDefault&&n.preventDefault(),n.returnValue=!1,!1):void 0},lf=function(){var n={};return isSafari||isOpera?(n.x=window.innerWidth,n.y=window.innerHeight):(n.x=document.documentElement.clientWidth||document.body.clientWidth||document.body.scrollWidth,n.y=document.documentElement.clientHeight||document.body.clientHeight||document.body.scrollHeight),n.mx=parseInt(n.x/2),n.my=parseInt(n.y/2),n},cf=function(n){var t={left:0,top:0};return n.pageX?isFirefox?(t.left=n.pageX-(document.pageXOffset?document.pageXOffset:0),t.top=n.pageY-(document.pageYOffset?document.pageYOffset:0)):(t.left=n.pageX-document.body.scrollLeft-document.body.clientLeft,t.top=n.pageY-document.body.scrollTop-document.body.clientTop):n.clientX&&(t.left=n.clientX,t.top=n.clientY),t},vf=function(n){for(var i=0,t=0;n&&!isNaN(n.offsetLeft)&&!isNaN(n.offsetTop);)i+=n.offsetLeft-n.scrollLeft,t+=n.offsetTop-n.scrollTop,n=n.offsetParent;return{top:t,left:i}},it=function(n){var n=window.event||n;n.preventDefault&&n.preventDefault(),n.returnValue=!1},hu=function(){alert("drag Ended")},su=function(n){OgEditor.cancelDefault(n)},lu=function(n){var r,t,i;for(it(n),r=n.target.files||n.dataTransfer.files,t=0;i=r[t];t++)ni(i)},cu=function(n){n=="none"||(ut=n)},lr=function(t){n("txtTempName").value=t},uu=function(t){n("txtCctrl").value=t},ru=function(){var t=n("txtCctrl").value,i=ogCControl[t];OgEditor.closeDialog(),s==""?OgEditor.openDialog(t,null,i.desc,"cctrl"):setTimeout("OgEditor.openDialog('"+t+"',null,'"+i.desc+"','cctrl');",100)},eu=function(t){n("divTemplateChartForHtml").style.display=t=="html"?"":"none"},ni=function(t){var e=t.name+":"+t.type+":"+t.size,f=OgEditor.getFileExtension(t.name),i,r,u;if(",html,htm,xml,js,css,txt,".indexOf(","+f+",")<0){alert("Upload denied. This file extension is forbidden! Please press [Upload file] button in FileManager to upload dynamic files.");return}alert("Files will be opened as "+ut+". \nThe encoding can be changed from Open menu."),i=new FileReader,i.onload=function(i){n("newFileContents").value=OgEditor.escapeTags(i.target.result),OgEditor.newFile("/"+t.name,"default",n("newFileContents").value),OgEditor.closeDialog()},t.type.indexOf("text")>=0&&(r=ut,u="readAsText",i[u](t,r))},bt=function(n,t){xmlhttp=isIE?new ActiveXObject("MSXML2.XMLHTTP"):new XMLHttpRequest,xmlhttp.open("GET",n,!0),t=="template"?isIE?xmlhttp.onreadystatechange=vt:xmlhttp.onload=vt:t=="component"&&(isIE?xmlhttp.onreadystatechange=st:xmlhttp.onload=st),xmlhttp.send("")},vt=function(){if(xmlhttp.readyState==4){for(var i=xmlhttp.responseText,t=1,n="/template.html";OgEditor.isExist(n,e);)n="/template"+t.toString()+".html",t++;OgEditor.newFile(n,"default",i),OgEditor.closeDialog()}},st=function(){if(xmlhttp.readyState==4){var n=xmlhttp.responseText;OgEditor.closeDialog()}},yu=function(i){var o,e,r,u,f;if(n("liHeading").className!="ddlLiOff"){for(o=OgEditor.getElementsByClassName("ddlcontainer"),e=0;e<o.length;e++)o[e].style.visibility="hidden";r=n("ddl"+i),r.style.visibility="visible",yt=!0,u=n("li"+i),f=OgEditor.getOffset(n("ogEditor_container")),isFirefox?(r.style.top=u.offsetTop+c+20+f.top+document.body.clientTop+"px",r.style.left=u.offsetLeft+f.left+document.body.clientLeft+"px"):(r.style.top=u.offsetTop+c+20+f.top+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)+document.body.clientTop+"px",r.style.left=u.offsetLeft+f.left+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)+document.body.clientLeft+"px"),n("edit_iframe"+t.toString()).contentWindow.ptrLocalEvt("findRange")}},pu=function(){n("edit_iframe"+t.toString()).contentWindow.focusDoc()},au=function(i){var r,f,u;if(i=i?i:event?event:null,i){if(r=i.target?i.target:i.srcElement,yt&&r.className!="lblForOgDDList"&&r.className!="ddlImg"){for(f=OgEditor.getElementsByClassName("ddlcontainer"),u=0;u<f.length;u++)f[u].style.visibility="hidden";yt=!1,n("edit_iframe"+t.toString()).contentWindow.clearRange()}else r.tagName.toUpperCase()!="A"&&r.tagName.toUpperCase()!="INPUT"&&r.tagName.toUpperCase()!="TEXTAREA"&&r.tagName.toUpperCase()!="SELECT"&&r.tagName.toUpperCase()!="OPTION"&&n("edit_iframe"+t.toString()).contentWindow.focusDoc();isIE&&pt&&(r.className!="liNaviMenu"||r.parentNode&&r.parentNode.className!="liNaviMenu")&&oi()}},oi=function(){for(var t=OgEditor.getElementsByClassName("mOver"),n=0;n<t.length;n++)t[n].className="";pt=!1},vu=function(){var i,n,u,o,r,t,f,e;for(i in ogDDList){for(n=ogDDList[i],u=document.createElement("div"),u.id=n.ddlistID,u.className=n.classID,o=document.createElement("ul"),o.className="ogContextDDList",t=0;t<n.ddlistItems.length;t++)r=document.createElement("li"),r.className="ddloption",r.id=n.ddlistItems[t].id,n.ddlistItems[t].click!=""&&(f="",n.ddlistItems[t].attribute=="tag"?f="<"+n.ddlistItems[t].value+' class="spanForOgDDList" onmouseup="'+n.ddlistItems[t].click+'" >'+n.ddlistItems[t].label+"</"+n.ddlistItems[t].value+">":n.ddlistItems[t].attribute=="style"&&(f=n.ddlistItems[t].property=="font-family"?'<span class="spanForOgDDList" onmouseup="'+n.ddlistItems[t].click+'" style="'+n.ddlistItems[t].property+":'"+n.ddlistItems[t].value+"';\">"+n.ddlistItems[t].label+"</span>":'<span class="spanForOgDDList" onmouseup="'+n.ddlistItems[t].click+'" style="'+n.ddlistItems[t].property+":"+n.ddlistItems[t].value+';">'+n.ddlistItems[t].label+"</span>"),r.innerHTML=f),o.appendChild(r);u.appendChild(o),document.body.appendChild(u)}for(e=this.getElementsByClassName("ddloption"),i=0;i<e.length;i++)OgEditor.addEvent(e[i],"mouseover",OgEditor.ogDDListItemMOver,!1),OgEditor.addEvent(e[i],"mouseout",OgEditor.ogDDListItemMOut,!1)},wu=function(){for(var t=OgEditor.getElementsByClassName("ddlcontainer"),n=0;n<t.length;n++)t[n].style.visibility="hidden"},du=function(n){if(n=n?n:event?event:null,n){var t=n.target?n.target:n.srcElement;t.className=="spanForOgDDList"&&(t=t.parentNode),t.className.indexOf("ddloption")!=-1&&(t.className="ddloptionOn")}},gu=function(n){if(n=n?n:event?event:null,n){var t=n.target?n.target:n.srcElement;t.className=="spanForOgDDList"&&(t=t.parentNode),t.className.indexOf("ddloption")!=-1&&(t.className="ddloption")}},bu=function(t){if(t=t?t:event?event:null,t){var i=t.target?t.target:t.srcElement;if(i.className=="lblForOgDDList"||i.className=="ddlImg"){if(n("liHeading").className=="ddlLiOff")return;i=OgEditor.getElemWithTagName("DIV",i)}i.className.indexOf("ddlmenu")!=-1&&(i.className="ddlmenuOn clearfx")}},ku=function(t){if(t=t?t:event?event:null,t){var i=t.target?t.target:t.srcElement;if(i.className=="lblForOgDDList"||i.className=="ddlImg"){if(n("liHeading").className=="ddlLiOff")return;i=OgEditor.getElemWithTagName("DIV",i)}i.className.indexOf("ddlmenu")!=-1&&(i.className="ddlmenu clearfx")}},fu=function(n){for(var r=OgEditor.getElementsByClassName("mOver"),i,t=0;t<r.length;t++)r[t].className="";i=n.parentNode,i.tagName.toUpperCase()=="LI"&&(i.className="mOver",pt=!0)},ou=function(n){for(var i=document.all?document.all:document.getElementsByTagName("*"),r=[],u=new RegExp("\\b"+n+"\\b"),t=0;t<i.length;t++)u.test(i[t].className)&&r.push(i[t]);return r},af=function(n,t,i){n.attachEvent?n.attachEvent("on"+t,i):n.addEventListener?n.addEventListener(t,i,!1):n["on"+t]=i},rf=function(){OgEditor.refreshFileManager(),OgEditor.closeDialog()},ur=function(){n("browser").contentWindow.refreshWindow()},dr=function(){n("edit_iframe"+t.toString()).contentWindow.addOnclickEventToChilds()};this.OgEditor||(OgEditor={isIE:isIE,isFirefox:isFirefox,dialogSaveAs:gt,validate_to_SaveAs_Interface:pe,displayFldPath:ts,uploadNewImage:ss,createNewFolder:cs,resultForNewFolder:ws,selectFolderAndClose:ih,isExist:be,setFileLoc:re,funcBtnPressed:bo,horizontalRule:vs,isEventSrcActive:lo,getWindowEvent:kt,getElemWithTagName:yo,openThirdDialog:eo,openSecondDialog:ro,openDialogSuccessed:fo,showFormatterDialg:co,showColoredHtmlDialg:ho,formatHTMLwithColors:vi,applyFormatterResult:oo,selectFileAndClose:th,closeThirdDialog:ie,closeSecondDialog:nh,insertNewTable:te,insertNewControl:ne,surroundWith:ae,showTabContainer:df,insertNewLink:le,strikethrough:ve,wordCharCount:se,setHeading:oe,setFontFamily:ce,setFontSize:he,pagebreak:ys,pickColor:as,selectColor:hs,insertNewImage:ds,moveCursor:ye,addAttribute:gs,showOrHideGuides:vo,updateGuideBtn:go,createNew:ks,saveAs_Interface:ke,setFolderInfo:ns,openDialog:io,insertCCtrl:sf,findNext:fe,replaceWith:ue,replaceAll:gf,showDialg:uo,closeDialog:rh,createDivs:ko,extctNum:ct,execCmd:ao,openDialogForDebug:so,refreshAndOpenDir:bs,copyToWebClipBoard:us,pasteFromWebClipBoard:os,pasteHtml:es,init:rs,initializeFuncBtns:is,slidePrev:or,goPrev:er,slideNext:hr,goNext:sr,slide:yr,addTab:gr,closeTab:wr,getFileExtension:br,setActive:fr,addEvent:af,remEvent:pi,printContents:yi,previewContents:li,textindentate:wi,toSource:ci,toEdit:ai,trim:ot,createSeparater:ar,createFuncBtns:dt,createCControl:cr,createFuncButton:vr,createImgButton:ir,makeBtnOver:tr,getHomePath:ui,addEditScreen:rr,setActiveFlder:nr,showOrHideFuncBtns:tu,switchTab:nu,getDirFromFilePath:pr,remTab:kr,loadFile_to_openFile:ki,waitAndOpenFile:bi,openFile:gi,openNewFileForIE:ee,getInternalStyles:di,setInlineStyles:iu,setElemAttributes:ef,setElemNodePath:hf,updateElemAttributes:ff,updateInternalStyle:tf,addNewAttribute:nf,clearAttriCssPane:of,newFile:uf,unEscapeTags:wt,escapeTags:wf,resize:pf,load:bf,showLoading:wo,hideLoading:po,cancelDefault:it,dragLeaved:su,fileDragEnd:hu,processFile:ni,createOgDDList:vu,focusDoc:pu,getCurPosition:cf,getOffset:vf,getScreenSize:lf,ogDDListItemClicked:wu,ogDDListItemMOver:du,ogDDListItemMOut:gu,lblDDlistMOut:ku,lblDDlistMOver:bu,ogNaviMenuLiHover:fu,showDDList:yu,hideDDlist:au,hideOgNavMenus:oi,keyDowned:yf,getElementsByClassName:ou,addOnclickEventToChilds:dr,writeEditorScreen:kf,loadText:bt,readLoadedText:vt,encSelected:cu,templateSelected:lr,dialgNewFileTypeSelected:eu,readLoadedComponent:st,dialogColorChanged:ps,refreshFileManager:ur,visitElem:fs,uploadNewFile:ls,cctrlSelected:uu,selectCctrl:ru,uploadHasDone:rf,fileDripped:lu})}(),OgEditor.addEvent(window,"load",OgEditor.load),OgEditor.addEvent(window,"resize",OgEditor.resize)